{"remainingRequest":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\radar\\src\\components\\Device\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\radar\\src\\components\\Device\\index.vue","mtime":1606995998539},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js","mtime":1596527889887},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js","mtime":1596528120726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport pagination from '@/components/utils/pagination';\nexport default {\n  components: {\n    pagination: pagination\n  },\n  data: function data() {\n    var validateIPAddress = function validateIPAddress(rule, value, callback) {\n      var regexp = /^((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}$/;\n      var valdata = value.split(',');\n      var isCorrect = true;\n\n      if (valdata.length) {\n        for (var i = 0; i < valdata.length; i++) {\n          if (regexp.test(valdata[i]) == false) {\n            isCorrect = false;\n          }\n        }\n      }\n\n      console.log('value', value);\n\n      if (value == '') {\n        return callback(new Error('请输入iP地址'));\n      } else if (!isCorrect) {\n        callback(new Error('请输入正确的ip地址'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      form: {\n        id: '',\n        name: '',\n        type: '',\n        subtype: '',\n        parentId: '',\n        hostIp: '',\n        ipmiIp: '',\n        position: '',\n        limit: 10,\n        pageIndex: 1,\n        pageSize: 10,\n        pageTotal: 0\n      },\n      addform: {},\n      items: [],\n      items1: [],\n      treedata: [],\n      defaultProps: {\n        children: 'sublist',\n        label: 'name'\n      },\n      tableData: [],\n      solts: [],\n      type: [],\n      deviceType: [],\n      subtype: [],\n      editVisible: false,\n      addVisible: false,\n      idx: -1,\n      rules: {\n        name: [{\n          required: true,\n          message: '请输入设备名称',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 5,\n          message: '长度在 3 到 5 个字符',\n          trigger: 'blur'\n        }],\n        type: [{\n          required: true,\n          message: '请选择设备类型',\n          trigger: 'change'\n        }],\n        hostIp: [{\n          required: true,\n          validator: validateIPAddress,\n          trigger: ['blur']\n        }],\n        ipmiIp: [{\n          required: true,\n          validator: validateIPAddress,\n          trigger: ['blur']\n        }]\n      }\n    };\n  },\n  methods: {\n    gettree: function gettree() {\n      var _this = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/sys/device/select',\n        // data: JSON.stringify({\n        //     subtypes: []\n        // }),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this.treedata = res.data.data;\n          console.log('this.treedata', _this.treedata);\n\n          for (var i = 0; i < res.data.data.length; i++) {\n            _this.items = res.data.data[i].sublist;\n          }\n\n          _this.items1 = res.data.data;\n          console.log('items1', _this.items1);\n        } else {\n          _this.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this.$message.error('获取数据失败！');\n      });\n    },\n    gettype: function gettype() {\n      var _this2 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=DeviceEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this2.type = res.data.data;\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this2.$message.error('获取数据失败！');\n      });\n    },\n    formatType: function formatType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code) {\n          typelable = this.type[i].value;\n        }\n      }\n\n      return typelable;\n    },\n    getDevicetype: function getDevicetype() {\n      var _this3 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=ChassisEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this3.deviceType = res.data.data;\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this3.$message.error('获取数据失败！');\n      });\n    },\n    getSubtype: function getSubtype() {\n      var _this4 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=BladeEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this4.subtype = res.data.data;\n\n          _this4.subtype.shift();\n\n          console.log('subtype', _this4.subtype);\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this4.$message.error('获取数据失败！');\n      });\n    },\n    formatsubType: function formatsubType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code && this.type[i].code === 4) {\n          for (var d = 0; d < this.deviceType.length; d++) {\n            if (row.subtype === this.deviceType[d].code) {\n              typelable = this.deviceType[d].value;\n            }\n          }\n        } else if (row.type === this.type[i].code && this.type[i].code === 5) {\n          for (var j = 0; j < this.subtype.length; j++) {\n            if (row.subtype === this.subtype[j].code) {\n              typelable = this.subtype[j].value;\n            }\n          }\n        }\n      }\n\n      return typelable;\n    },\n    //添加设备\n    addDevice: function addDevice() {\n      this.addVisible = true;\n    },\n    saveAdd: function saveAdd(form) {\n      var _this5 = this;\n\n      this.$refs[form].validate(function (valid) {\n        if (valid) {\n          _this5.addVisible = false;\n\n          if (_this5.addform.parentId == \"\") {\n            _this5.addform.parentId = _this5.items[0].parentId;\n          }\n\n          _this5.$axios({\n            method: \"POST\",\n            url: '/sys/device/save',\n            data: JSON.stringify(_this5.addform),\n            headers: {\n              'Content-Type': \"application/json\"\n            },\n            withCredentials: true\n          }).then(function (res) {\n            var data = res.data;\n\n            if (data.code == 0) {\n              _this5.$message.success('操作完成');\n\n              _this5.gettree(); //局部刷新表格               \n\n            } else {\n              _this5.$message.error(data.msg || '操作失败');\n            }\n\n            _this5.uploadLoading = false;\n          }).catch(function (e) {\n            _this5.uploadLoading = false;\n\n            _this5.$message.error(e);\n          });\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    // 触发搜索按钮\n    handleSearch: function handleSearch() {\n      this.gettree();\n    },\n    // 删除操作\n    handleDelete: function handleDelete(index, row) {\n      var _this6 = this;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      } // 确认删除\n\n\n      this.$confirm('确定要删除吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this6.saveDelete();\n      }).catch(function () {});\n    },\n    saveDelete: function saveDelete() {\n      var _this7 = this;\n\n      var ids = [];\n      ids.push(this.form.id + \"\");\n      console.log(ids);\n      this.$axios({\n        method: \"post\",\n        url: '/sys/device/delete',\n        data: JSON.stringify(ids),\n        // 设置请求头\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true //跨域请求\n\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this7.$message.success('操作完成');\n\n          _this7.gettree(); //局部刷新表格                     \n\n        } else {\n          _this7.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this7.$message.error(e);\n      });\n    },\n    // 编辑操作\n    handleEdit: function handleEdit(index, row) {\n      this.editVisible = true; // this.idx = index;\n\n      this.form = row;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      }\n    },\n    // 保存编辑\n    saveEdit: function saveEdit() {\n      var _this8 = this;\n\n      console.log('this.form', this.form);\n      this.editVisible = false; // 文件上传\n\n      this.$axios({\n        method: \"POST\",\n        url: '/sys/device/update',\n        data: JSON.stringify(this.form),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this8.$message.success('操作完成'); // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\n\n\n          _this8.gettree(); //局部刷新表格               \n\n        } else {\n          _this8.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this8.$message.error(e);\n      });\n    },\n    //控制树形菜单\n    handleNodeClick: function handleNodeClick(data) {\n      if (data) {\n        if (data.sublist.length > 0) {\n          this.items = data.sublist;\n        } else {\n          var select = [];\n          select.push(data);\n          this.items = select;\n        }\n      }\n    }\n  },\n  created: function created() {\n    this.gettype();\n    this.getDevicetype();\n    this.getSubtype();\n    this.gettree();\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n<div>\r\n    <div class=\"crumbs\">\r\n        <el-breadcrumb separator=\"/\">\r\n            <el-breadcrumb-item>\r\n                <i class=\"el-icon-lx-cascades\"></i> 设备管理\r\n            </el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n    </div>\r\n    <div class=\"container\">\r\n        <el-row :gutter=\"20\">\r\n            <el-col :span=\"4\" style=\"height:400px\">\r\n                <el-card shadow=\"hover\" class=\"mgb20\">\r\n                    <div slot=\"header\" class=\"clearfix\">\r\n                        <h2>设备列表</h2>\r\n                    </div>\r\n                    <el-tree :data=\"treedata\" node-key=\"menuId\" :default-expanded-keys=\"[246]\" :props=\"defaultProps\" accordion @node-click=\"handleNodeClick\"></el-tree>\r\n                </el-card>\r\n            </el-col>\r\n            <el-col :span=\"20\">\r\n                <el-card shadow=\"hover\" class=\"mgb20\">\r\n                    <div class=\"handle-box\">\r\n                        <el-button class=\"handle-add mr10\" @click=\"addDevice\"><i class=\"el-icon-circle-plus\" style=\"font-size:12px;color:#00EC00;margin-right: 5px;\"></i>增加</el-button>\r\n                        <el-input placeholder=\"设备名\" v-model=\"form.name\" class=\"handle-input mr10\"></el-input>\r\n                        <el-button @click=\"handleSearch\"><i class=\"el-icon-search\" style=\"font-size:12px;color:blue;margin-right: 5px;\"></i>搜索</el-button>\r\n                    </div>\r\n                    <el-table :data=\"items\" style=\"width: 100%;margin-bottom: 20px;\" border stripe default-expand-all>\r\n                        <el-table-column prop=\"deviceId\" label=\"设备编号\"></el-table-column>\r\n                        <el-table-column prop=\"name\" label=\"设备名称\" width=\"180\"></el-table-column>\r\n\r\n                        <el-table-column prop=\"type\" label=\"设备类型\" width=\"180\" :formatter=\"formatType\"></el-table-column>\r\n                        <el-table-column prop=\"subtype\" label=\"设备子类型\" width=\"180\" :formatter=\"formatsubType\"></el-table-column>\r\n                        <el-table-column prop=\"hostIp\" label=\"主机IP\"></el-table-column>\r\n                        <el-table-column prop=\"ipmiIp\" label=\"BMCIP\"></el-table-column>\r\n                        <el-table-column prop=\"position\" label=\"槽位号\"></el-table-column>\r\n\r\n                        <el-table-column label=\"操作\" width=\"200\" align=\"center\">\r\n                            <template slot-scope=\"scope\">\r\n                                <el-button type=\"text\" icon=\"el-icon-edit\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\r\n                                <el-button type=\"text\" icon=\"el-icon-delete\" class=\"red\" @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\r\n                            </template>\r\n                        </el-table-column>\r\n                    </el-table>\r\n\r\n                    <!--分页组件>\r\n                    <pagination  :query1=\"form\"/-->\r\n                </el-card>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n\r\n    <!-- 编辑弹出框 -->\r\n    <el-dialog title=\"编辑设备\" :visible.sync=\"editVisible\" width=\"30%\">\r\n        <el-form ref=\"form\" :model=\"form\" label-width=\"100px\" style=\"width: 300px; margin-left:50px;\">\r\n            <el-form-item label=\"设备名称\">\r\n                <el-input v-model=\"form.name\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"设备类型\">\r\n                <el-radio-group v-model=\"form.type\">\r\n                    <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in type\">{{item.value}}</el-radio>\r\n                </el-radio-group>\r\n            </el-form-item>\r\n            <template v-if=\"form.type===4\">\r\n                <el-form-item label=\"设备子类型\">\r\n                    <el-select v-model=\"form.subtype\">\r\n                        <el-option v-for=\"device in deviceType\" :key=\"device.code\" :label=\"device.value\" :value=\"device.code\">{{device.value}}</el-option>\r\n                    </el-select>\r\n                    <!--el-radio-group v-model=\"form.subtype\">\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in deviceType\">{{item.value}}</el-radio>\r\n                    </el-radio-group-->\r\n                </el-form-item>\r\n            </template>\r\n            <template v-else-if=\"form.type===5\">\r\n                <el-form-item label=\"上级设备\">\r\n                    <el-select v-model=\"form.parentId\">\r\n                        <el-option v-for=\"tree in items1\" :key=\"tree.deviceId\" :label=\"tree.name\" :value=\"tree.deviceId\">{{tree.name}}</el-option>\r\n                    </el-select>\r\n                    <!--el-radio-group v-model=\"form.subtype\">\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in deviceType\">{{item.value}}</el-radio>\r\n                    </el-radio-group-->\r\n                </el-form-item>\r\n                <el-form-item label=\"设备子类型\">\r\n                    <el-select v-model=\"form.subtype\">\r\n                        <el-option v-for=\"solt in subtype\" :key=\"solt.code\" :label=\"solt.value\" :value=\"solt.code\">{{solt.value}}</el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"主机IP\">\r\n                    <el-input v-model=\"form.hostIp\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"BMCIP\">\r\n                    <el-input v-model=\"form.ipmiIp\"></el-input>\r\n                </el-form-item>\r\n                <template v-if=\"form.subtype===6\">\r\n                    <el-form-item label=\"槽位号\" hidden>\r\n                        <el-input v-model=\"form.position\"></el-input>\r\n                    </el-form-item>\r\n                </template>\r\n                <template v-else>\r\n                    <el-form-item label=\"槽位号\">\r\n                        <el-input v-model=\"form.position\"></el-input>\r\n                    </el-form-item>\r\n                </template>\r\n            </template>\r\n        </el-form>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button @click=\"editVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" @click=\"saveEdit\">确 定</el-button>\r\n        </span>\r\n    </el-dialog>\r\n\r\n    <!--增加弹出框-->\r\n    <el-dialog title=\"增加设备\" :visible.sync=\"addVisible\" width=\"40%\">\r\n        <el-form :model=\"addform\" :rules=\"rules\" ref=\"form\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\r\n            <el-form-item label=\"设备名称\" prop=\"name\">\r\n                <el-input v-model=\"addform.name\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"设备类型\" prop=\"type\">\r\n                <el-radio-group v-model=\"addform.type\">\r\n                    <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in type\">{{item.value}}</el-radio>\r\n                </el-radio-group>\r\n            </el-form-item>\r\n            <template v-if=\"addform.type===4\">\r\n                <el-form-item label=\"设备子类型\">\r\n                    <el-select v-model=\"addform.subtype\">\r\n                        <el-option v-for=\"device in deviceType\" :key=\"device.code\" :label=\"device.value\" :value=\"device.code\">{{device.value}}</el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n            </template>\r\n            <template v-else-if=\"addform.type===5\">\r\n                <el-form-item label=\"上级设备\">\r\n                    <el-select v-model=\"addform.parentId\">\r\n                        <el-option v-for=\"tree in items1\" :key=\"tree.deviceId\" :label=\"tree.name\" :value=\"tree.deviceId\">{{tree.name}}</el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"设备子类型\">\r\n                    <el-select v-model=\"addform.subtype\">\r\n                        <el-option v-for=\"solt in subtype\" :key=\"solt.code\" :label=\"solt.value\" :value=\"solt.code\">{{solt.value}}</el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"主机IP\" prop=\"hostIp\">\r\n                    <el-input v-model=\"addform.hostIp\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"BMCIP\" prop=\"ipmiIp\">\r\n                    <el-input v-model=\"addform.ipmiIp\"></el-input>\r\n                </el-form-item>\r\n                <template v-if=\"addform.subtype==6\">\r\n                    <el-form-item label=\"槽位号\" hidden>\r\n                        <el-input v-model=\"addform.position\"></el-input>\r\n                    </el-form-item>\r\n                </template>\r\n                <template v-else>\r\n                    <el-form-item label=\"槽位号\">\r\n                        <el-input v-model=\"form.position\"></el-input>\r\n                    </el-form-item>\r\n                </template>\r\n            </template>\r\n        </el-form>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button @click=\"addVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" @click=\"saveAdd('addform')\">确 定</el-button>\r\n        </span>\r\n    </el-dialog>\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport pagination from '@/components/utils/pagination'\r\nexport default {\r\n    components: {\r\n        pagination\r\n    },\r\n    data() {\r\n        let validateIPAddress = (rule, value, callback) => {\r\n            let regexp = /^((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}$/;\r\n            let valdata = value.split(',');\r\n            let isCorrect = true;\r\n            if (valdata.length) {\r\n                for (let i = 0; i < valdata.length; i++) {\r\n                    if (regexp.test(valdata[i]) == false) {\r\n                        isCorrect = false;\r\n                    }\r\n                }\r\n            }\r\n            console.log('value', value);\r\n            if (value == '') {\r\n                return callback(new Error('请输入iP地址'));\r\n            } else if (!isCorrect) {\r\n                callback(new Error('请输入正确的ip地址'));\r\n            } else {\r\n                callback()\r\n            }\r\n        }\r\n        return {\r\n            form: {\r\n                id: '',\r\n                name: '',\r\n                type: '',\r\n                subtype: '',\r\n                parentId: '',\r\n                hostIp: '',\r\n                ipmiIp: '',\r\n                position: '',\r\n                limit: 10,\r\n                pageIndex: 1,\r\n                pageSize: 10,\r\n                pageTotal: 0\r\n            },\r\n            addform: {},\r\n            items: [],\r\n            items1: [],\r\n            treedata: [],\r\n            defaultProps: {\r\n                children: 'sublist',\r\n                label: 'name'\r\n            },\r\n            tableData: [],\r\n            solts: [],\r\n            type: [],\r\n            deviceType: [],\r\n            subtype: [],\r\n            editVisible: false,\r\n            addVisible: false,\r\n            idx: -1,\r\n            rules: {\r\n                name: [{\r\n                        required: true,\r\n                        message: '请输入设备名称',\r\n                        trigger: 'blur'\r\n                    },\r\n                    {\r\n                        min: 3,\r\n                        max: 5,\r\n                        message: '长度在 3 到 5 个字符',\r\n                        trigger: 'blur'\r\n                    }\r\n                ],\r\n                type: [{\r\n                    required: true,\r\n                    message: '请选择设备类型',\r\n                    trigger: 'change'\r\n                }],\r\n                hostIp: [{\r\n                    required: true,\r\n                    validator: validateIPAddress,\r\n                    trigger: ['blur']\r\n                }],\r\n                ipmiIp: [{\r\n                    required: true,\r\n                    validator: validateIPAddress,\r\n                    trigger: ['blur']\r\n                }]\r\n\r\n            }\r\n        }\r\n\r\n    },\r\n    methods: {\r\n        gettree() {\r\n            this.$axios({\r\n                method: \"get\",\r\n                url: '/sys/device/select',\r\n                // data: JSON.stringify({\r\n                //     subtypes: []\r\n                // }),\r\n                headers: {\r\n                    'Content-Type': \"application/json\"\r\n                },\r\n                withCredentials : true\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.treedata = res.data.data;\r\n                    console.log('this.treedata', this.treedata);\r\n                    for (var i = 0; i < res.data.data.length; i++) {\r\n                        this.items = res.data.data[i].sublist;\r\n                    }\r\n                    this.items1 = res.data.data;\r\n                    console.log('items1', this.items1);\r\n                } else {\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n        },\r\n        gettype() {\r\n            this.$axios({\r\n                method: \"get\",\r\n                url: '/getData/getEnum?enumName=DeviceEnum',\r\n                withCredentials: true,\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.type = res.data.data;\r\n                } else {\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n        },\r\n        formatType(row, column) {\r\n            var typelable = '';\r\n            for (var i = 0; i < this.type.length; i++) {\r\n                if (row.type === this.type[i].code) {\r\n                    typelable = this.type[i].value;\r\n                }\r\n            }\r\n            return typelable;\r\n        },\r\n        getDevicetype() {\r\n            this.$axios({\r\n                method: \"get\",\r\n                url: '/getData/getEnum?enumName=ChassisEnum',\r\n                withCredentials: true,\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.deviceType = res.data.data;\r\n                } else {\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n        },\r\n        getSubtype() {\r\n            this.$axios({\r\n                method: \"get\",\r\n                url: '/getData/getEnum?enumName=BladeEnum',\r\n                withCredentials: true,\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.subtype = res.data.data;\r\n                    this.subtype.shift();\r\n                    console.log('subtype', this.subtype);\r\n                } else {\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n        },\r\n        formatsubType(row, column) {\r\n            var typelable = '';\r\n            for (var i = 0; i < this.type.length; i++) {\r\n                if (row.type === this.type[i].code && this.type[i].code === 4) {\r\n                    for (var d = 0; d < this.deviceType.length; d++) {\r\n                        if (row.subtype === this.deviceType[d].code) {\r\n                            typelable = this.deviceType[d].value;\r\n                        }\r\n                    }\r\n                } else if (row.type === this.type[i].code && this.type[i].code === 5) {\r\n                    for (var j = 0; j < this.subtype.length; j++) {\r\n                        if (row.subtype === this.subtype[j].code) {\r\n                            typelable = this.subtype[j].value;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return typelable;\r\n        },\r\n        //添加设备\r\n        addDevice() {\r\n            this.addVisible = true;\r\n        },\r\n        saveAdd(form) {\r\n            this.$refs[form].validate((valid) => {\r\n                if (valid) {\r\n                    this.addVisible = false;\r\n                    if (this.addform.parentId == \"\") {\r\n                        this.addform.parentId = this.items[0].parentId;\r\n                    }\r\n                    this.$axios({\r\n                        method: \"POST\",\r\n                        url: '/sys/device/save',\r\n                        data: JSON.stringify(this.addform),\r\n                        headers: {\r\n                            'Content-Type': \"application/json\"\r\n                        },\r\n                        withCredentials: true,\r\n                    }).then((res) => {\r\n                        let data = res.data\r\n                        if (data.code == 0) {\r\n                            this.$message.success('操作完成');\r\n                            this.gettree(); //局部刷新表格               \r\n                        } else {\r\n                            this.$message.error(data.msg || '操作失败')\r\n                        }\r\n                        this.uploadLoading = false\r\n                    }).catch((e) => {\r\n                        this.uploadLoading = false\r\n                        this.$message.error(e)\r\n                    });\r\n                } else {\r\n                    console.log('error submit!!');\r\n                    return false;\r\n                }\r\n            });\r\n\r\n        },\r\n        // 触发搜索按钮\r\n        handleSearch() {\r\n            this.gettree();\r\n        },\r\n        // 删除操作\r\n        handleDelete(index, row) {\r\n            if (row.type === 4) {\r\n                this.form.id = row.menuId;\r\n            } else {\r\n                this.form.id = row.deviceId;\r\n            }\r\n            // 确认删除\r\n            this.$confirm('确定要删除吗？', '提示', {\r\n                type: 'warning'\r\n            }).then(() => {\r\n                this.saveDelete();\r\n            }).catch(() => {});\r\n        },\r\n        saveDelete() {\r\n            let ids = [];\r\n            ids.push(this.form.id + \"\");\r\n            console.log(ids);\r\n            this.$axios({\r\n                method: \"post\",\r\n                url: '/sys/device/delete',\r\n                data: JSON.stringify(ids),\r\n                // 设置请求头\r\n                headers: {\r\n                    'Content-Type': \"application/json\"\r\n                },\r\n                withCredentials: true, //跨域请求\r\n            }).then((res) => {\r\n                let data = res.data;\r\n                if (data.code == 0) {\r\n                    this.$message.success('操作完成');\r\n                    this.gettree(); //局部刷新表格                     \r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n            }).catch((e) => {\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        // 编辑操作\r\n        handleEdit(index, row) {\r\n            this.editVisible = true;\r\n            // this.idx = index;\r\n            this.form = row;\r\n            if (row.type === 4) {\r\n                this.form.id = row.menuId;\r\n            } else {\r\n                this.form.id = row.deviceId;\r\n            }\r\n\r\n        },\r\n        // 保存编辑\r\n        saveEdit() {\r\n            console.log('this.form', this.form);\r\n            this.editVisible = false;\r\n            // 文件上传\r\n            this.$axios({\r\n                method: \"POST\",\r\n                url: '/sys/device/update',\r\n                data: JSON.stringify(this.form),\r\n                headers: {\r\n                    'Content-Type': \"application/json\"\r\n                },\r\n                withCredentials: true,\r\n            }).then((res) => {\r\n                let data = res.data\r\n                if (data.code == 0) {\r\n                    this.$message.success('操作完成');\r\n                    // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\r\n                    this.gettree(); //局部刷新表格               \r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n            }).catch((e) => {\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        //控制树形菜单\r\n        handleNodeClick(data) {\r\n            if (data) {\r\n                if (data.sublist.length > 0) {\r\n                    this.items = data.sublist;\r\n                } else {\r\n                    var select = [];\r\n                    select.push(data);\r\n                    this.items = select;\r\n                }\r\n            }\r\n        },\r\n    },\r\n    created: function () {\r\n        this.gettype();\r\n        this.getDevicetype();\r\n        this.getSubtype();\r\n        this.gettree();\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.handle-box {\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.handle-select {\r\n    width: 120px;\r\n}\r\n\r\n.handle-input {\r\n    width: 200px;\r\n    display: inline-block;\r\n}\r\n\r\n.table {\r\n    width: 100%;\r\n    font-size: 14px;\r\n}\r\n\r\n.red {\r\n    color: #ff0000;\r\n}\r\n\r\n.mr10 {\r\n    margin-right: 10px;\r\n}\r\n\r\n.table-td-thumb {\r\n    display: block;\r\n    margin: auto;\r\n    width: 40px;\r\n    height: 40px;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/Device"}]}