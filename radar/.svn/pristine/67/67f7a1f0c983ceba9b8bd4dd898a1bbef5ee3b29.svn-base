{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"icon\"],{\"0643\":function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"div\",{staticClass:\"crumbs\"},[a(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[a(\"el-breadcrumb-item\",[a(\"i\",{staticClass:\"el-icon-lx-cascades\"}),e._v(\" 设备管理\\n            \")])],1)],1),a(\"div\",{staticClass:\"container\"},[a(\"el-row\",{attrs:{gutter:20}},[a(\"el-col\",{staticStyle:{height:\"400px\"},attrs:{span:4}},[a(\"el-card\",{staticClass:\"mgb20\",attrs:{shadow:\"hover\"}},[a(\"div\",{staticClass:\"clearfix\",attrs:{slot:\"header\"},slot:\"header\"},[a(\"span\",[e._v(\"设备列表\")])]),a(\"el-tree\",{attrs:{data:e.treedata,\"node-key\":\"menuId\",\"default-expanded-keys\":[246],props:e.defaultProps},on:{\"node-click\":e.handleNodeClick}})],1)],1),a(\"el-col\",{attrs:{span:20}},[a(\"el-card\",{staticClass:\"mgb20\",attrs:{shadow:\"hover\"}},[a(\"div\",{staticClass:\"handle-box\"},[a(\"el-button\",{staticClass:\"handle-add mr10\",on:{click:e.addDevice}},[a(\"i\",{staticClass:\"el-icon-plus\",staticStyle:{\"font-size\":\"12px\",color:\"#00EC00\",\"margin-right\":\"5px\"}}),e._v(\"添加\")]),a(\"el-input\",{staticClass:\"handle-input mr10\",attrs:{placeholder:\"设备名\"}}),a(\"el-button\",[a(\"i\",{staticClass:\"el-icon-search\",staticStyle:{\"font-size\":\"12px\",color:\"#0080FF\",\"margin-right\":\"5px\"}}),e._v(\"搜索\")])],1),a(\"el-table\",{staticStyle:{width:\"100%\",\"margin-bottom\":\"20px\"},attrs:{data:e.items,border:\"\",\"default-expand-all\":\"\"}},[a(\"el-table-column\",{attrs:{prop:\"name\",label:\"设备名称\",width:\"180\"}}),a(\"el-table-column\",{attrs:{prop:\"chassis\",label:\"设备编号\"}}),a(\"el-table-column\",{attrs:{prop:\"type\",label:\"设备类型\",width:\"180\",formatter:e.formatType}}),a(\"el-table-column\",{attrs:{prop:\"subtype\",label:\"设备子类型\",width:\"180\",formatter:e.formatsubType}}),a(\"el-table-column\",{attrs:{prop:\"ipmiIp\",label:\"设备IP\"}}),a(\"el-table-column\",{attrs:{prop:\"slotPosition\",label:\"槽位号\"}}),a(\"el-table-column\",{attrs:{label:\"操作\",width:\"200\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{type:\"text\",icon:\"el-icon-edit\"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v(\"编辑\")]),a(\"el-button\",{staticClass:\"red\",attrs:{type:\"text\",icon:\"el-icon-delete\"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v(\"删除\")])]}}])})],1)],1)],1)],1)],1),a(\"el-dialog\",{attrs:{title:\"编辑设备\",visible:e.editVisible,width:\"30%\"},on:{\"update:visible\":function(t){e.editVisible=t}}},[a(\"el-form\",{ref:\"form\",staticStyle:{width:\"300px\",\"margin-left\":\"50px\"},attrs:{model:e.form,\"label-width\":\"100px\"}},[a(\"el-form-item\",{attrs:{label:\"设备名称\"}},[a(\"el-input\",{model:{value:e.form.name,callback:function(t){e.$set(e.form,\"name\",t)},expression:\"form.name\"}})],1),a(\"el-form-item\",{attrs:{label:\"设备类型\"}},[a(\"el-radio-group\",{model:{value:e.form.type,callback:function(t){e.$set(e.form,\"type\",t)},expression:\"form.type\"}},e._l(e.type,(function(t){return a(\"el-radio\",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.value))])})),1)],1),4===e.form.type?[a(\"el-form-item\",{attrs:{label:\"设备子类型\"}},[a(\"el-select\",{model:{value:e.form.subtype,callback:function(t){e.$set(e.form,\"subtype\",t)},expression:\"form.subtype\"}},e._l(e.deviceType,(function(t){return a(\"el-option\",{key:t.code,attrs:{label:t.value,value:t.code}},[e._v(e._s(t.value))])})),1)],1)]:5===e.form.type?[a(\"el-form-item\",{attrs:{label:\"上级设备\"}},[a(\"el-select\",{model:{value:e.form.parentId,callback:function(t){e.$set(e.form,\"parentId\",t)},expression:\"form.parentId\"}},e._l(e.items,(function(t){return a(\"el-option\",{key:t.menuId,attrs:{label:t.name,value:t.menuId}},[e._v(e._s(t.name))])})),1)],1),a(\"el-form-item\",{attrs:{label:\"设备子类型\"}},[a(\"el-select\",{model:{value:e.form.subtype,callback:function(t){e.$set(e.form,\"subtype\",t)},expression:\"form.subtype\"}},e._l(e.subtype,(function(t){return a(\"el-option\",{key:t.code,attrs:{label:t.value,value:t.code}},[e._v(e._s(t.value))])})),1)],1),a(\"el-form-item\",{attrs:{label:\"设备IP\"}},[a(\"el-input\",{model:{value:e.form.ipmiIp,callback:function(t){e.$set(e.form,\"ipmiIp\",t)},expression:\"form.ipmiIp\"}})],1),a(\"el-form-item\",{attrs:{label:\"槽位号\"}},[a(\"el-input\",{model:{value:e.form.slotPosition,callback:function(t){e.$set(e.form,\"slotPosition\",t)},expression:\"form.slotPosition\"}})],1)]:e._e()],2),a(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:function(t){e.editVisible=!1}}},[e._v(\"取 消\")]),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.saveEdit}},[e._v(\"确 定\")])],1)],1),a(\"el-dialog\",{attrs:{title:\"增加设备\",visible:e.addVisible,width:\"40%\"},on:{\"update:visible\":function(t){e.addVisible=t}}},[a(\"el-form\",{ref:\"form\",staticStyle:{width:\"400px\",\"margin-left\":\"50px\"},attrs:{model:e.form,\"label-width\":\"100px\"}},[a(\"el-form-item\",{attrs:{label:\"设备名称\"}},[a(\"el-input\",{model:{value:e.form.name,callback:function(t){e.$set(e.form,\"name\",t)},expression:\"form.name\"}})],1),a(\"el-form-item\",{attrs:{label:\"设备类型\"}},[a(\"el-radio-group\",{model:{value:e.form.type,callback:function(t){e.$set(e.form,\"type\",t)},expression:\"form.type\"}},e._l(e.type,(function(t){return a(\"el-radio\",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.value))])})),1)],1),4===e.form.type?[a(\"el-form-item\",{attrs:{label:\"设备子类型\"}},[a(\"el-select\",{model:{value:e.form.subtype,callback:function(t){e.$set(e.form,\"subtype\",t)},expression:\"form.subtype\"}},e._l(e.deviceType,(function(t){return a(\"el-option\",{key:t.code,attrs:{label:t.value,value:t.code}},[e._v(e._s(t.value))])})),1)],1)]:5===e.form.type?[a(\"el-form-item\",{attrs:{label:\"上级设备\"}},[a(\"el-select\",{model:{value:e.form.parentId,callback:function(t){e.$set(e.form,\"parentId\",t)},expression:\"form.parentId\"}},e._l(e.items,(function(t){return a(\"el-option\",{key:t.menuId,attrs:{label:t.name,value:t.menuId}},[e._v(e._s(t.name))])})),1)],1),a(\"el-form-item\",{attrs:{label:\"设备子类型\"}},[a(\"el-select\",{model:{value:e.form.subtype,callback:function(t){e.$set(e.form,\"subtype\",t)},expression:\"form.subtype\"}},e._l(e.subtype,(function(t){return a(\"el-option\",{key:t.code,attrs:{label:t.value,value:t.code}},[e._v(e._s(t.value))])})),1)],1),a(\"el-form-item\",{attrs:{label:\"设备IP\"}},[a(\"el-input\",{model:{value:e.form.ipmiIp,callback:function(t){e.$set(e.form,\"ipmiIp\",t)},expression:\"form.ipmiIp\"}})],1),a(\"el-form-item\",{attrs:{label:\"槽位号\"}},[a(\"el-input\",{model:{value:e.form.slotPosition,callback:function(t){e.$set(e.form,\"slotPosition\",t)},expression:\"form.slotPosition\"}})],1)]:e._e()],2),a(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:function(t){e.addVisible=!1}}},[e._v(\"取 消\")]),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.saveAdd}},[e._v(\"确 定\")])],1)],1)],1)},o=[],i={data:function(){return{form:{id:\"\",name:\"\",type:\"\",subtype:\"\",parentId:\"\",ipmiIp:\"\",slotPosition:\"\"},items:[],treedata:[],defaultProps:{children:\"sublist\",label:\"name\"},tableData:[],solts:[],type:[],deviceType:[],subtype:[],editVisible:!1,addVisible:!1,idx:-1}},methods:{getDevice:function(){},gettree:function(){var e=this;this.$axios({method:\"get\",url:\"/sys/device/select\",withCredentials:!0}).then((function(t){if(0==t.data.code){e.treedata=t.data.data;for(var a=0;a<t.data.data.length;a++)e.items=t.data.data[a].sublist}else e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(\"获取数据失败！\")}))},gettype:function(){var e=this;this.$axios({method:\"get\",url:\"/getData/getEnum?enumName=DeviceEnum\",withCredentials:!0}).then((function(t){0==t.data.code?e.type=t.data.data:e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(\"获取数据失败！\")}))},formatType:function(e,t){for(var a=\"\",s=0;s<this.type.length;s++)e.type===this.type[s].code&&(a=this.type[s].value);return a},getDevicetype:function(){var e=this;this.$axios({method:\"get\",url:\"/getData/getEnum?enumName=ChassisEnum\",withCredentials:!0}).then((function(t){0==t.data.code?e.deviceType=t.data.data:e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(\"获取数据失败！\")}))},getSubtype:function(){var e=this;this.$axios({method:\"get\",url:\"/getData/getEnum?enumName=BladeEnum\",withCredentials:!0}).then((function(t){0==t.data.code?e.subtype=t.data.data:e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(\"获取数据失败！\")}))},formatsubType:function(e,t){for(var a=\"\",s=0;s<this.type.length;s++)if(e.type===this.type[s].code&&4===this.type[s].code)for(var o=0;o<this.deviceType.length;o++)e.subtype===this.deviceType[o].code&&(a=this.deviceType[o].value);else if(e.type===this.type[s].code&&5===this.type[s].code)for(var i=0;i<this.subtype.length;i++)e.subtype===this.subtype[i].code&&(a=this.subtype[i].value);return a},addDevice:function(){this.addVisible=!0},saveAdd:function(){var e=this;this.addVisible=!1,\"\"==this.form.parentId&&(this.form.parentId=this.items[0].parentId),console.log(this.items),console.log(this.form),this.$axios({method:\"POST\",url:\"/sys/device/save\",data:JSON.stringify(this.form),headers:{\"Content-Type\":\"application/json\"},withCredentials:!0}).then((function(t){var a=t.data;0==a.code?(e.$message.success(\"操作完成\"),e.gettree()):e.$message.error(a.msg||\"操作失败\"),e.uploadLoading=!1})).catch((function(t){e.uploadLoading=!1,e.$message.error(t)}))},handleDelete:function(e,t){var a=this;4===t.type?this.form.id=t.menuId:this.form.id=t.deviceId,this.$confirm(\"确定要删除吗？\",\"提示\",{type:\"warning\"}).then((function(){a.saveDelete()})).catch((function(){}))},saveDelete:function(){var e=this,t=[];t.push(this.form.id+\"\"),console.log(t),this.$axios({method:\"post\",url:\"/sys/device/delete\",data:JSON.stringify(t),headers:{\"Content-Type\":\"application/json\"},withCredentials:!0}).then((function(t){var a=t.data;0==a.code?(e.$message.success(\"操作完成\"),e.gettree()):e.$message.error(a.msg||\"操作失败\")})).catch((function(t){e.$message.error(t)}))},handleEdit:function(e,t){this.editVisible=!0,this.form=t,4===t.type?this.form.id=t.menuId:this.form.id=t.deviceId},saveEdit:function(){var e=this;console.log(this.form),this.editVisible=!1,this.$axios({method:\"POST\",url:\"/sys/device/update\",data:JSON.stringify(this.form),headers:{\"Content-Type\":\"application/json\"},withCredentials:!0}).then((function(t){var a=t.data;0==a.code?(e.$message.success(\"操作完成\"),e.gettree()):e.$message.error(a.msg||\"操作失败\")})).catch((function(t){e.$message.error(t)}))},handleNodeClick:function(e){var t=this;console.log(e),this.$axios({method:\"get\",url:\"/sys/device/status/tree?devicePid=\"+e.menuId,withCredentials:!0}).then((function(e){0==e.data.code?t.items=e.data.devices:t.$message.error(e.data.msg)})).catch((function(e){t.$message.error(\"获取数据失败！\")}))}},created:function(){this.gettype(),this.getDevicetype(),this.getSubtype(),this.getDevice(),this.gettree()}},l=i,r=(a(\"3a70\"),a(\"2877\")),n=Object(r[\"a\"])(l,s,o,!1,null,\"632229c6\",null);t[\"default\"]=n.exports},\"1c6c\":function(e,t,a){},\"3a70\":function(e,t,a){\"use strict\";var s=a(\"1c6c\"),o=a.n(s);o.a}}]);","extractedComments":[]}