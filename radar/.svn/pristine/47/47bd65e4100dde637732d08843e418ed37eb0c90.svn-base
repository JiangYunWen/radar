{"remainingRequest":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\radar\\src\\components\\Phytopo\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\radar\\src\\components\\Phytopo\\index.vue","mtime":1607404833429},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1596528110531},{"path":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js","mtime":1596527889887},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js","mtime":1596528120726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { fetchData } from '../../api/index';\nexport default {\n    data() {\n        return {\n            configData: [],\n            progressData: [],\n            nodeDataArray: [],\n            linkDataArray: []\n        }\n    },\n    methods: {\n        // 获取 easy-mock 的模拟数据\n        getData() {\n            fetchData(this.query).then(res => {\n\n                //连线\n                var links = [];\n                for (var l = 0; l < res.SoltsLinks.length; l++) {\n                    var link = {};\n                    link[\"from\"] = res.SoltsLinks[l].from;\n                    link[\"to\"] = res.SoltsLinks[l].to;\n                    link[\"category\"] = res.SoltsLinks[l].category;\n                    link[\"fromSpot\"] = res.SoltsLinks[l].fromSpot;\n                    link[\"toSpot\"] = res.SoltsLinks[l].toSpot;\n                    links.push(link);\n                }\n                this.linkDataArray = links;\n                console.log('this.linkDataArray', this.linkDataArray);\n\n                //节点\n                var solts = [];\n                for (var i = 0; i < res.OnlineSolts.length; i++) {\n                    //首先第一个大组\n                    var group1 = {};\n                    group1[\"isGroup\"] = true;\n                    group1[\"key\"] = res.OnlineSolts[i].key;\n                    group1[\"subtype\"] = res.OnlineSolts[i].subtype;\n                    group1[\"text\"] = res.OnlineSolts[i].text;\n                    group1[\"category\"] = res.OnlineSolts[i].category;\n                    group1[\"size\"] = res.OnlineSolts[i].size;\n                    solts.push(group1);\n\n                    var Group = res.OnlineSolts[i].Group.length;\n                    //第二层组\n                    for (var j = 0; j < Group; j++) {\n                        var group2 = {};\n                        group2[\"key\"] = res.OnlineSolts[i].Group[j].key;\n                        group2[\"group\"] = res.OnlineSolts[i].Group[j].group;\n                        group2[\"isGroup\"] = true;\n                        group2[\"category\"] = res.OnlineSolts[i].Group[j].category;\n                        group2[\"pos\"] = res.OnlineSolts[i].Group[j].pos;\n                        group2[\"text\"] = res.OnlineSolts[i].Group[j].text;\n                        group2[\"size\"] = res.OnlineSolts[i].Group[j].size;\n                        solts.push(group2);\n\n                        var model = res.OnlineSolts[i].Group[j].Chips.length;\n                        //第三层模块\n                        if (model > 0) {\n                            for (var m = 0; m < model; m++) {\n                                var models = {};\n                                models[\"key\"] = res.OnlineSolts[i].Group[j].Chips[m].key;\n                                models[\"text\"] = res.OnlineSolts[i].Group[j].Chips[m].text;\n                                models[\"group\"] = res.OnlineSolts[i].Group[j].Chips[m].group;\n                                models[\"category\"] = res.OnlineSolts[i].Group[j].Chips[m].category;\n                                models[\"pos\"] = res.OnlineSolts[i].Group[j].Chips[m].pos;\n                                models[\"ribbon\"] = res.OnlineSolts[i].Group[j].Chips[m].ribbon;\n                                models[\"ribbon1\"] = res.OnlineSolts[i].Group[j].Chips[m].ribbon1;\n                                models[\"color\"] = res.OnlineSolts[i].Group[j].Chips[m].color;\n\n                                solts.push(models);\n                            }\n                        }\n                    }\n                }\n\n                this.nodeDataArray = solts;\n                this.setTopo();\n            });\n        },\n        setTopo() {\n            if (window.goSamples) goSamples(); // init for these samples -- you don't need to call this\n            var $ = go.GraphObject.make; // for conciseness in defining templates\n            var myDiagram =\n                $(go.Diagram, \"myDiagramDiv\", // Diagram refers to its DIV HTML element by id\n                    {\n                        maxSelectionCount: 1, // no more than 1 element can be selected at a time\n                        allowHorizontalScroll: true, // disallow scrolling or panning\n                        allowVerticalScroll: true,\n                        allowZoom: true, // disallow zooming\n                        allowMove: false,\n                        \"animationManager.isEnabled\": false,\n                        \"undoManager.isEnabled\": false,\n                        scale: 0.4,    //初始视图大小比例\n                    });\n            // the background Part showing the fixed bounds of the diagram contents\n            //   myDiagram.add(\n            //     $(go.Part,\n            //       { layerName: \"Horizontal\", position: myDiagram.fixedBounds.position },\n            //       $(go.Shape, { fill: \"oldlace\", strokeWidth: 0, desiredSize: myDiagram.fixedBounds.size })\n            //     ));\n\n            // this function is the Node.dragComputation, to limit the movement of the parts\n            // use GRIDPT instead of PT if DraggingTool.isGridSnapEnabled and movement should snap to grid\n            function stayInFixedArea(part, pt, gridpt) {\n                var diagram = part.diagram;\n                if (diagram === null) return pt;\n                // compute the document area without padding\n                var v = diagram.documentBounds.copy();\n                v.subtractMargin(diagram.padding);\n                // get the bounds of the part being dragged\n                var b = part.actualBounds;\n                var loc = part.location;\n                // now limit the location appropriately\n                var x = Math.max(v.x, Math.min(pt.x, v.right - b.width)) + (loc.x - b.x);\n                var y = Math.max(v.y, Math.min(pt.y, v.bottom - b.height)) + (loc.y - b.y);\n                return new go.Point(x, y);\n            }\n            myDiagram.nodeTemplateMap.add(\"Rectangle\",\n                $(go.Node, \"Spot\", {\n                    avoidable: true\n                }, {\n                    dragComputation: stayInFixedArea\n                },\n                    // get the size from the model data\n                    new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                    // get and set the position in the model data\n                    new go.Binding(\"position\", \"pos\", go.Point.parse).makeTwoWay(go.Point.stringify),\n\n                    $(go.Panel, \"Auto\", {\n                        name: \"\",\n                        width: 75,\n                        height: 75\n                    },\n                        // { portId: \"\" },\n                        // { position: new go.Point(50, 50), background: \"\" },\n                        $(go.Shape, {\n                            fill: \"white\",\n                            stroke: null,\n                            strokeWidth: 0\n                        }),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"text\"), {\n                            width: 90,\n                            textAlign: \"center\"\n                        })\n                    ),\n                    //黑块小三角\n                    $(go.Panel, \"Spot\",\n                        new go.Binding(\"opacity\", \"ribbon\", function (t) {\n                            return t ? 1 : 0;\n                        }),\n                        // note that the opacity defaults to zero (not visible),\n                        // in case there is no \"ribbon\" property\n                        {\n                            opacity: 0,\n                            alignment: new go.Spot(1, 0, 0, 0),\n                            alignmentFocus: go.Spot.TopRight\n                        },\n                        $(go.Shape, // the ribbon itself\n                            {\n                                geometryString: \"F1 M0 0 L50 0 50 50 50 50z\",\n                                fill: \"black\",\n                                stroke: null,\n                                strokeWidth: 0\n                            }),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"ribbon\"), {\n                            alignment: new go.Spot(1, 0, -20, 15),\n                            angle: 45,\n                            maxSize: new go.Size(100, NaN),\n                            stroke: \"white\",\n                            font: \"bold 13px sans-serif\",\n                            textAlign: \"center\"\n                        })\n                    ),\n\n                    //cpu占用\n                    $(go.Panel, \"Spot\",\n                        new go.Binding(\"opacity\", \"ribbon1\", function (t) {\n                            return t ? 1 : 0;\n                        }),\n                        // note that the opacity defaults to zero (not visible),\n                        // in case there is no \"ribbon\" property\n                        {\n                            opacity: 0,\n                            alignment: new go.Spot(1, 0.7, 0, 0),\n                            alignmentFocus: go.Spot.TopRight\n                        },\n                        $(go.Shape,\n                            new go.Binding(\"fill\", \"color\"), {\n                            geometryString: \"F10 M25 25 L25 0 100 0 100 25z\",\n                            fill: \"green\",\n                            stroke: null,\n                            strokeWidth: 0\n                        }\n                        ),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"ribbon1\", function (t) {\n                                return t + \"%\";\n                            }), {\n                            angle: 0,\n                            maxSize: new go.Size(100, NaN),\n                            stroke: \"white\",\n                            font: \"bold 13px sans-serif\",\n                            textAlign: \"center\"\n                        })\n                    )\n                )\n            );\n\n            //串口\n            myDiagram.nodeTemplateMap.add(\"ManualOperation\",\n                $(go.Node, \"Spot\",\n                    // new go.Binding(\"location\", \"loc\"),\n                    {\n                        locationSpot: go.Spot.Center,\n                        locationObjectName: \"BODY\",\n                        toEndSegmentLength: 30,\n                        fromEndSegmentLength: 30\n                    }, {\n                    selectionObjectName: \"BODY\"\n                },\n\n                    $(go.Panel, \"Auto\", {\n                        name: \"BODY\",\n                        width: 70,\n                        height: 30\n                    },\n                        // { portId: \"\" },\n                        // { position: new go.Point(-50, 50), background: \"lightgreen\" },\n                        $(go.Shape, \"ManualOperation\", {\n                            fill: \"white\",\n                            stroke: null,\n                            strokeWidth: 0\n                        }),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"text\"), {\n                            width: 90,\n                            textAlign: \"center\"\n                        })\n                    ),\n                )\n            );\n\n            //以太网\n            myDiagram.nodeTemplateMap.add(\"Srio\",\n                $(go.Node, \"Spot\",\n                    $(go.Panel, \"Auto\", {\n                        name: \"BODY\",\n                        width: 60,\n                        height: 60\n                    }, {\n                        portId: \"\"\n                    }, {\n                        position: new go.Point(-50, 50),\n                        background: \"black\"\n                    },\n                        $(go.Shape, \"DividedEvent\", {\n                            fill: \"white\",\n                            stroke: null,\n                            strokeWidth: 0\n                        }),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"text\"), {\n                            width: 90,\n                            textAlign: \"center\"\n                        })\n                    ),\n                )\n            );\n\n            //40G或SRIO\n            myDiagram.nodeTemplateMap.add(\"StopSign\",\n                $(go.Node, \"Spot\", {\n                    dragComputation: stayInFixedArea\n                },\n                    new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                    // get and set the position in the model data\n                    new go.Binding(\"position\", \"pos\", go.Point.parse),\n                    $(go.Panel, \"Auto\", {\n                        name: \"BODY\",\n                        width: 72,\n                        height: 72\n                    },\n                        // { portId: \"\" },\n                        // { position: new go.Point(-50, 50), background: \"lightgreen\" },\n                        $(go.Shape, \"StopSign\", {\n                            fill: \"white\",\n                            stroke: null,\n                            strokeWidth: 0\n                        }),\n                        $(go.TextBlock,\n                            new go.Binding(\"text\", \"text\"), {\n                            width: 70,\n                            textAlign: \"center\"\n                        })\n                    ),\n                )\n            );\n\n            myDiagram.groupTemplateMap.add(\"test\", $(go.Group, \"Auto\", {\n\n            },\n                // declare the Group.layout:\n                {\n                    dragComputation: stayInFixedArea\n                },\n                new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                new go.Binding(\"position\", \"pos\", go.Point.parse),\n                $(go.Shape, \"Rectangle\", // surrounds everything\n                    {\n                        parameter1: 10,\n                        fill: \"rgba(128,128,128,0.33)\"\n                    }\n                ),\n                $(go.Panel, \"Auto\", {\n                    width: 400,\n                    height: 0\n                }, // position header above the subgraph\n                    $(go.TextBlock, // group title near top, next to button\n                        new go.Binding(\"text\", \"text\"), {\n                        font: \"Bold 12pt Sans-Serif\",\n                        textAlign: \"Bottom\",\n                        width: 60,\n                        wrap: go.TextBlock.WrapDesiredSize\n                    }),\n                    // $(go.Placeholder, // represents area for all member parts\n                    // )\n                )\n            ));\n\n            //多个组模板定义,\"OfGroup1\"为组模板的分类,在json用category指定组使用的模板\n            myDiagram.groupTemplateMap.add(\"OfGroup1\", $(go.Group, \"Auto\",\n                // declare the Group.layout:\n                {\n                    dragComputation: stayInFixedArea\n                },\n                new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                // get and set the position in the model data\n                // new go.Binding(\"position\", \"pos\", go.Point.parse),\n                //   { layout: $(go.GridLayout,{\n                //      arrangement: ''\n                //   }) },\n                $(go.Shape, \"Rectangle\", // surrounds everything\n                    {\n                        parameter1: 10,\n                        fill: \"rgba(128,128,128,0.33)\"\n                    }\n                ),\n                $(go.Panel, \"Auto\", {\n\n                }, // position header above the subgraph\n                    $(go.TextBlock, // group title near top, next to button\n                        new go.Binding(\"text\", \"text\"), {\n                        font: \"Bold 12pt Sans-Serif\",\n                        textAlign: \"left\"\n                    }),\n                    $(go.Placeholder, // represents area for all member parts\n                        {\n                            padding: 5,\n                        })\n                )\n            ));\n\n            myDiagram.groupTemplateMap.add(\"OfGroup2\", $(go.Group, \"Auto\",\n                // declare the Group.layout:\n                {\n                    layout: $(go.LayeredDigraphLayout, {})\n                }, {\n                dragComputation: stayInFixedArea\n            },\n                new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                // get and set the position in the model data\n                new go.Binding(\"position\", \"pos\", go.Point.parse),\n                $(go.Shape, \"Rectangle\", // surrounds everything\n                    {\n                        parameter1: 10,\n                        fill: \"rgba(128,128,128,0.33)\"\n                    }\n                ),\n                $(go.Panel, \"Auto\", {\n                    width: 150,\n                    height: 180\n                }, // position header above the subgraph\n                    $(go.TextBlock, // group title near top, next to button\n                        {\n                            font: \"Bold 12pt Sans-Serif\"\n                        },\n                        new go.Binding(\"text\", \"text\")),\n                    $(go.Placeholder, // represents area for all member parts\n                        {\n                            padding: 5,\n                        })\n                )\n            ));\n\n            myDiagram.groupTemplateMap.add(\"OfGroup3\", $(go.Group, \"Auto\",\n                // declare the Group.layout:\n                //   { layout: $(go.GridLayout,{\n                //      arrangement: go.GridLayout.LeftToRight\n                //   }) },\n                {\n                    dragComputation: stayInFixedArea\n                },\n                new go.Binding(\"desiredSize\", \"size\", go.Size.parse),\n                // get and set the position in the model data\n                new go.Binding(\"position\", \"pos\", go.Point.parse),\n                $(go.Shape, \"Rectangle\", // surrounds everything\n                    {\n                        parameter1: 10,\n                        fill: \"rgba(128,128,128,0.33)\"\n                    }\n                ),\n                $(go.Panel, \"Vertical\", {\n                    width: 200,\n                    height: 180\n                }, // position header above the subgraph\n                    $(go.TextBlock, // group title near top, next to button\n                        {\n                            font: \"Bold 12pt Sans-Serif\"\n                        },\n                        new go.Binding(\"text\", \"text\")),\n                    $(go.Placeholder, // represents area for all member parts\n                        {\n                            padding: 5,\n                        })\n                )\n            ));\n\n            // declare the Diagram.layout:\n            myDiagram.layout = $(go.LayeredDigraphLayout, {\n                direction: 90,\n                layerSpacing: 10,\n                isRealtime: false,\n                columnSpacing: 10\n            });\n\n            myDiagram.linkTemplateMap.add(\"Orthogonal\",\n                // myDiagram.linkTemplate =\n                $(go.Link,\n                    new go.Binding(\"fromSpot\", \"fromSpot\", go.Spot.parse),\n                    new go.Binding(\"toSpot\", \"toSpot\", go.Spot.parse), {\n                    selectable: false, // links cannot be selected by the user\n                    routing: go.Link.AvoidsNodes,\n                    curve: go.Link.JumpOver,\n                    layerName: \"Background\" // don't cross in front of any nodes\n                },\n                    $(go.Shape, // this shape only shows when it isHighlighted\n                        {\n                            isPanelMain: true,\n                            stroke: null,\n                            strokeWidth: 5\n                        },\n                        new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n                            return h ? \"#436EEE\" : null;\n                        }).ofObject()),\n                    $(go.Shape,\n                        // mark each Shape to get the link geometry with isPanelMain: true\n                        {\n                            isPanelMain: true,\n                            stroke: \"#436EEE\",\n                            strokeWidth: 2\n                        },\n                        new go.Binding(\"stroke\", \"color\")),\n                    $(go.Shape, {\n                        toArrow: \"Standard\"\n                    }),\n                )\n            );\n\n            myDiagram.linkTemplateMap.add(\"Link\",\n                // myDiagram.linkTemplate =\n                $(go.Link, {\n                    routing: go.Link.AvoidsNodes, // may be either Orthogonal or AvoidsNodes\n                    curve: go.Link.JumpOver\n                },\n                    $(go.Shape),\n                    $(go.Shape, {\n                        toArrow: \"Standard\"\n                    })\n                ));\n\n            console.log(\"this.nodeDataArray\", this.nodeDataArray);\n            myDiagram.model = new go.GraphLinksModel(this.nodeDataArray, this.linkDataArray);\n\n        },\n\n        getconfig() {\n            this.$axios({\n                method: \"post\",\n                url: '/sys/device/getconfig',\n                data: JSON.stringify({\n                    \"deviceId\": this.$route.params.menuId,\n                    \"key\": \"bhost_netconfig\"\n                }),\n                headers: {\n                    'Content-Type': \"application/json\"\n                },\n                withCredentials: true,\n            }).then(res => {\n                if (res.data.code == 0) {\n                    this.configData = res.data.data.config.data;\n\n                } else {\n                    this.$message.error(res.data.msg);\n                    clearInterval(this.cpu);\n                }\n            }).catch(error => {\n                this.$message.error('获取数据失败！');\n                clearInterval(this.cpu);\n            });\n        },\n        getProgressData() {\n            this.$axios({\n                method: \"post\",\n                url: '/sys/device/status',\n                data: JSON.stringify({\n                    id: this.$route.params.menuId,\n                    \"isSub\": true,\n                    \"keys\": [\n                        \"bht_host_sysprocess\"\n                    ]\n                }),\n                headers: {\n                    'Content-Type': \"application/json\"\n                },\n                withCredentials: true,\n            }).then(res => {\n                if (res.data.code == 0) {\n                    this.progressData = res.data.data.status.bht_host_sysprocess.data;\n\n                } else {\n                    this.$message.error(res.data.msg);\n                    clearInterval(this.cpu);\n                }\n            }).catch(error => {\n                this.$message.error('获取数据失败！');\n                clearInterval(this.cpu);\n            });\n        }\n    },\n    mounted: function () {\n        // this.getProgressData();\n        // this.getconfig();\n        this.getData();\n    }\n}\n",null]}