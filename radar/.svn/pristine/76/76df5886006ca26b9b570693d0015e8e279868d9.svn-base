{"remainingRequest":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\360极速浏览器下载\\vue-manage-system-master\\src\\components\\page\\Device.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\src\\components\\page\\Device.vue","mtime":1594604943446},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  data() {\n    return {\n      form:{\n          id:'',\n          name:'',\n          type:'',\n          subtype:'',\n          parentId:'',\n          ipmiIp:'',\n          slotPosition:''\n      },\n      items:[],\n      treedata:[],\n      defaultProps:{\n          children: 'sublist',\n          label: 'name'\n      },\n      tableData: [],\n      solts:[],\n      type:[],\n      deviceType:[],\n      subtype:[],\n      editVisible: false,\n      addVisible:false,\n      idx: -1,\n    }\n  },\n  methods: {\n   //机箱数据获取\n    getDevice(){\n          // this.$axios({\n          //     method:\"get\",\n          //     url:'/sys/device/status/tree?devicePid=246',\n          //     withCredentials:true,\n          // }).then(res => {\n          //     if(res.data.code==0){                                                     \n          //         this.items=res.data.devices;\n          //     }else{\n          //         this.$message.error(res.data.msg);\n          //     }\n          // }).catch(error => {\n          //     this.$message.error('获取数据失败！');\n          // });\n    },\n    gettree(){\n          this.$axios({\n              method:\"get\",\n              url:'/sys/device/select',\n              withCredentials:true,\n          }).then(res => {\n              if(res.data.code==0){       \n                  // this.items=res.data.data.sublist;                                              \n                  this.treedata=res.data.data;\n                  for(var i=0;i<res.data.data.length;i++){\n                      this.items=res.data.data[i].sublist;\n                  }\n                  \n              }else{\n                  this.$message.error(res.data.msg);\n              }\n          }).catch(error => {\n              this.$message.error('获取数据失败！');\n          });\n    },\n      gettype(){\n          this.$axios({\n              method:\"get\",\n              url:'/getData/getEnum?enumName=DeviceEnum',\n              withCredentials:true,\n          }).then(res => {\n              if(res.data.code==0){                                                     \n                  this.type=res.data.data;\n              }else{\n                  this.$message.error(res.data.msg);\n              }\n          }).catch(error => {\n              this.$message.error('获取数据失败！');\n          });\n    },\n    formatType(row, column){\n          var typelable=''; \n          for(var i=0;i<this.type.length;i++){\n              if(row.type===this.type[i].code){\n                  typelable=this.type[i].value;\n              }\n          }\n          return typelable;\n    },\n      getDevicetype(){\n          this.$axios({\n              method:\"get\",\n              url:'/getData/getEnum?enumName=ChassisEnum',\n              withCredentials:true,\n          }).then(res => {\n              if(res.data.code==0){                                                     \n                  this.deviceType=res.data.data;\n              }else{\n                      this.$message.error(res.data.msg);\n              }\n          }).catch(error => {\n              this.$message.error('获取数据失败！');\n          });\n    },\n      getSubtype(){\n          this.$axios({\n              method:\"get\",\n              url:'/getData/getEnum?enumName=BladeEnum',\n              withCredentials:true,\n          }).then(res => {\n              if(res.data.code==0){                                                     \n                  this.subtype=res.data.data;\n              }else{\n                      this.$message.error(res.data.msg);\n              }\n          }).catch(error => {\n              this.$message.error('获取数据失败！');\n          });\n    },\n    formatsubType(row, column){\n          var typelable=''; \n           for(var i=0;i<this.type.length;i++){\n              if(row.type===this.type[i].code&&this.type[i].code===4){\n                   for(var d=0;d<this.deviceType.length;d++){\n                        if(row.subtype===this.deviceType[d].code){\n                              typelable=this.deviceType[d].value;\n                        }\n                   }\n              }else if(row.type===this.type[i].code&&this.type[i].code===5){\n                  for(var j=0;j<this.subtype.length;j++){\n                        if(row.subtype===this.subtype[j].code){\n                              typelable=this.subtype[j].value;                               \n                        }\n                   }\n              }\n          }\n          return typelable;\n    },\n    //添加设备\n      addDevice(){\n          this.addVisible = true;\n      },\n      saveAdd(){\n          this.addVisible = false;\n          if(this.form.parentId==\"\"){\n                  this.form.parentId=this.items[0].parentId;              \n          }\n          console.log(this.items);\n          console.log(this.form);\n          this.$axios({\n              method: \"POST\",\n              url: '/sys/device/save',\n              data: JSON.stringify(this.form),\n              headers: {\n                      'Content-Type': \"application/json\"\n               },\n               withCredentials:true,\n          }).then((res) => {\n              let data = res.data\n              if(data.code==0) {         \n                  this.$message.success('操作完成') ;\n                  this.gettree();//局部刷新表格               \n              } else {\n                  this.$message.error(data.msg || '操作失败')\n              }\n              this.uploadLoading = false\n          }).catch((e)=>{\n              this.uploadLoading = false\n              this.$message.error(e)\n          });\n      },\n      // 删除操作\n      handleDelete(index, row) {\n          if(row.type===4){\n              this.form.id = row.menuId;       \n          }else{\n              this.form.id = row.deviceId;  \n          }\n          // 确认删除\n          this.$confirm('确定要删除吗？', '提示', {\n              type: 'warning'\n          }).then(() => {\n                  this.saveDelete();\n              }).catch(() => {});\n      },\n      saveDelete(){   \n          let ids=[];                         \n          ids.push(this.form.id+\"\");\n          console.log(ids);\n          this.$axios({\n              method: \"post\",\n              url: '/sys/device/delete',\n              data: JSON.stringify(ids),\n              // 设置请求头\n              headers: {\n                 'Content-Type': \"application/json\"\n              },\n               withCredentials:true,//跨域请求\n          }).then((res) => {\n              let data = res.data;\n              if(data.code==0) {         \n                  this.$message.success('操作完成') ;\n                  this.gettree();//局部刷新表格                     \n              } else {\n                  this.$message.error(data.msg || '操作失败')\n              }\n          }).catch((e)=>{\n              this.$message.error(e)\n          });\n      },\n      // 编辑操作\n      handleEdit(index, row) {\n          this.editVisible = true;\n\n          // this.idx = index;\n          this.form = row;\n          if(row.type===4){\n              this.form.id = row.menuId;       \n          }else{\n              this.form.id = row.deviceId;  \n          }\n             \n      },\n      // 保存编辑\n      saveEdit() {\n          console.log(this.form);\n          this.editVisible = false;\n          // 文件上传\n          this.$axios({\n              method: \"POST\",\n              url: '/sys/device/update',\n              data: JSON.stringify(this.form),\n              headers: {\n                      'Content-Type': \"application/json\"\n               },\n               withCredentials:true,\n          }).then((res) => {\n              let data = res.data\n              if(data.code==0) {         \n                  this.$message.success('操作完成') ;\n                  // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\n                 this.gettree();//局部刷新表格               \n              } else {\n                  this.$message.error(data.msg || '操作失败')\n              }\n          }).catch((e)=>{\n              this.$message.error(e)\n          });\n      },\n      //控制树形菜单\n      handleNodeClick(data) {\n      console.log(data);\n       this.$axios({\n              method:\"get\",\n              url:'/sys/device/status/tree?devicePid='+data.menuId,\n              withCredentials:true,\n          }).then(res => {\n              if(res.data.code==0){                                                     \n                  this.items=res.data.devices;\n              }else{\n                  this.$message.error(res.data.msg);\n              }\n          }).catch(error => {\n              this.$message.error('获取数据失败！');\n          });\n    },\n  },\n  created:function(){\n      this.gettype();\n      this.getDevicetype();\n      this.getSubtype();\n      this.getDevice();\n      this.gettree();\n  }\n}\n",null]}