{"remainingRequest":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\radar\\src\\components\\CrateSolt\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\radar\\src\\components\\CrateSolt\\index.vue","mtime":1600243587597},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1596528110531},{"path":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js","mtime":1596527889887},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js","mtime":1596528120726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport SoltStatus from '@/components/SoltStatus'\r\nvar list = [{\r\n    name: '',\r\n    status: '',\r\n    cpu: '',\r\n    memory: ''\r\n}];\r\nexport default {\r\n    components: {\r\n        SoltStatus\r\n    },\r\n    props: ['msg'],\r\n    data() {\r\n        return {\r\n            msg: this.msg,\r\n            solts: [],\r\n            checkAll: false,\r\n            checkedCities: [],\r\n            cities: [],\r\n            isIndeterminate: false,\r\n            IpmiCmdEnum: [],\r\n            form: {\r\n                cmdid: 0,\r\n                ids: []\r\n            },\r\n            viewclass: 'bat fa fa-battery-0 fa-fw'\r\n        }\r\n    },\r\n    methods: {\r\n        msgTolist() {\r\n            var array = [];\r\n            for (var i = 0; i < 14; i++) {\r\n                array.push(list[0]);\r\n            }\r\n            if (this.msg == null) {\r\n                this.solts = array;\r\n                return;\r\n            }\r\n            for (var i = 0; i < this.msg.length; i++) {\r\n                if (this.msg[i].status.brt_bmc_sys != null) {\r\n                    this.msg[i].status.brt_bmc_sys['ssdRate'] = Math.round((this.msg[i].status.brt_bmc_sys.usedSSDSize / this.msg[i].status.brt_bmc_sys.ssdsize) * 100);\r\n                    this.cities[i] = this.msg[i].deviceId;\r\n                    array[this.msg[i].slotPosition - 1] = this.msg[i];\r\n                } else {\r\n                    array[this.msg[i].slotPosition - 1] = this.msg[i];\r\n                }\r\n            }\r\n            this.solts = array;\r\n\r\n        },\r\n        //全选\r\n        handleCheckAllChange(val) {\r\n            this.checkedCities = val ? this.cities : [];\r\n            this.isIndeterminate = false;\r\n        },\r\n        //单选及反选\r\n        handleCheckedCitiesChange(value) {\r\n            this.form.ids = value;\r\n            let checkedCount = value.length;\r\n            this.checkAll = checkedCount === this.cities.length;\r\n            this.isIndeterminate = checkedCount > 0 && checkedCount < this.cities.length;\r\n        },\r\n        IpmiCmd(cmd) {\r\n            this.$axios({\r\n                method: \"POST\",\r\n                url: '/sys/device/cmd/ipmi',\r\n                data: JSON.stringify(this.form),\r\n                headers: {\r\n                    'Content-Type': \"application/json\"\r\n                },\r\n                withCredentials: true,\r\n            }).then((res) => {\r\n                let data = res.data\r\n                if (data.code == 0) {\r\n                    this.$message.success('操作完成');\r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n                this.uploadLoading = false\r\n            }).catch((e) => {\r\n                this.uploadLoading = false\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        //命令\r\n        Action(cmd) {\r\n            this.$axios({\r\n                method: \"get\",\r\n                url: '/getData/getEnum?enumName=IpmiCmdEnum',\r\n                withCredentials: true,\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.IpmiCmdEnum = res.data.data;\r\n                    for (var i = 0; i < this.IpmiCmdEnum.length; i++) {\r\n                        if (this.IpmiCmdEnum[i].code === cmd) {\r\n                            this.form.cmdid = this.IpmiCmdEnum[i].code;\r\n                            this.IpmiCmd();\r\n                        }\r\n                    }\r\n\r\n                } else {\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n        }\r\n    },\r\n    //监听数据变化\r\n    watch: {\r\n        msg: {\r\n            handler(newVal) {\r\n                this.msgTolist();\r\n            },\r\n            deep: true\r\n        },\r\n    },\r\n    mounted: function () {\r\n        this.msgTolist();\r\n        //全选全不选\r\n        $(\"#checkAll\").click(function () {\r\n            $('input[name=\"check\"]').attr(\"checked\", this.checked);\r\n        });\r\n        var $subBox = $(\"input[name='check']\");\r\n        $subBox.click(function () {\r\n            $(\"#checkAll\").attr(\"checked\", $subBox.length == $(\"input[name='check']:checked\").length ? true : false);\r\n        });\r\n\r\n        //反选*****\r\n    }\r\n}\r\n",null]}