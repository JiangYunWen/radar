{"remainingRequest":"D:\\vue\\radar\\node_modules\\thread-loader\\dist\\cjs.js!D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\radar\\src\\components\\Device\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\radar\\src\\components\\Device\\index.vue","mtime":1606995998539},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1596528110531},{"path":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js","mtime":1596527889887},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js","mtime":1596528120726}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport pagination from '@/components/utils/pagination';\nexport default {\n  components: {\n    pagination: pagination\n  },\n  data: function data() {\n    var validateIPAddress = function validateIPAddress(rule, value, callback) {\n      var regexp = /^((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}$/;\n      var valdata = value.split(',');\n      var isCorrect = true;\n\n      if (valdata.length) {\n        for (var i = 0; i < valdata.length; i++) {\n          if (regexp.test(valdata[i]) == false) {\n            isCorrect = false;\n          }\n        }\n      }\n\n      console.log('value', value);\n\n      if (value == '') {\n        return callback(new Error('请输入iP地址'));\n      } else if (!isCorrect) {\n        callback(new Error('请输入正确的ip地址'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      form: {\n        id: '',\n        name: '',\n        type: '',\n        subtype: '',\n        parentId: '',\n        hostIp: '',\n        ipmiIp: '',\n        position: '',\n        limit: 10,\n        pageIndex: 1,\n        pageSize: 10,\n        pageTotal: 0\n      },\n      addform: {},\n      items: [],\n      items1: [],\n      treedata: [],\n      defaultProps: {\n        children: 'sublist',\n        label: 'name'\n      },\n      tableData: [],\n      solts: [],\n      type: [],\n      deviceType: [],\n      subtype: [],\n      editVisible: false,\n      addVisible: false,\n      idx: -1,\n      rules: {\n        name: [{\n          required: true,\n          message: '请输入设备名称',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 5,\n          message: '长度在 3 到 5 个字符',\n          trigger: 'blur'\n        }],\n        type: [{\n          required: true,\n          message: '请选择设备类型',\n          trigger: 'change'\n        }],\n        hostIp: [{\n          required: true,\n          validator: validateIPAddress,\n          trigger: ['blur']\n        }],\n        ipmiIp: [{\n          required: true,\n          validator: validateIPAddress,\n          trigger: ['blur']\n        }]\n      }\n    };\n  },\n  methods: {\n    gettree: function gettree() {\n      var _this = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/sys/device/select',\n        // data: JSON.stringify({\n        //     subtypes: []\n        // }),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this.treedata = res.data.data;\n          console.log('this.treedata', _this.treedata);\n\n          for (var i = 0; i < res.data.data.length; i++) {\n            _this.items = res.data.data[i].sublist;\n          }\n\n          _this.items1 = res.data.data;\n          console.log('items1', _this.items1);\n        } else {\n          _this.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this.$message.error('获取数据失败！');\n      });\n    },\n    gettype: function gettype() {\n      var _this2 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=DeviceEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this2.type = res.data.data;\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this2.$message.error('获取数据失败！');\n      });\n    },\n    formatType: function formatType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code) {\n          typelable = this.type[i].value;\n        }\n      }\n\n      return typelable;\n    },\n    getDevicetype: function getDevicetype() {\n      var _this3 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=ChassisEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this3.deviceType = res.data.data;\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this3.$message.error('获取数据失败！');\n      });\n    },\n    getSubtype: function getSubtype() {\n      var _this4 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=BladeEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this4.subtype = res.data.data;\n\n          _this4.subtype.shift();\n\n          console.log('subtype', _this4.subtype);\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this4.$message.error('获取数据失败！');\n      });\n    },\n    formatsubType: function formatsubType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code && this.type[i].code === 4) {\n          for (var d = 0; d < this.deviceType.length; d++) {\n            if (row.subtype === this.deviceType[d].code) {\n              typelable = this.deviceType[d].value;\n            }\n          }\n        } else if (row.type === this.type[i].code && this.type[i].code === 5) {\n          for (var j = 0; j < this.subtype.length; j++) {\n            if (row.subtype === this.subtype[j].code) {\n              typelable = this.subtype[j].value;\n            }\n          }\n        }\n      }\n\n      return typelable;\n    },\n    //添加设备\n    addDevice: function addDevice() {\n      this.addVisible = true;\n    },\n    saveAdd: function saveAdd(form) {\n      var _this5 = this;\n\n      this.$refs[form].validate(function (valid) {\n        if (valid) {\n          _this5.addVisible = false;\n\n          if (_this5.addform.parentId == \"\") {\n            _this5.addform.parentId = _this5.items[0].parentId;\n          }\n\n          _this5.$axios({\n            method: \"POST\",\n            url: '/sys/device/save',\n            data: JSON.stringify(_this5.addform),\n            headers: {\n              'Content-Type': \"application/json\"\n            },\n            withCredentials: true\n          }).then(function (res) {\n            var data = res.data;\n\n            if (data.code == 0) {\n              _this5.$message.success('操作完成');\n\n              _this5.gettree(); //局部刷新表格               \n\n            } else {\n              _this5.$message.error(data.msg || '操作失败');\n            }\n\n            _this5.uploadLoading = false;\n          }).catch(function (e) {\n            _this5.uploadLoading = false;\n\n            _this5.$message.error(e);\n          });\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    // 触发搜索按钮\n    handleSearch: function handleSearch() {\n      this.gettree();\n    },\n    // 删除操作\n    handleDelete: function handleDelete(index, row) {\n      var _this6 = this;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      } // 确认删除\n\n\n      this.$confirm('确定要删除吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this6.saveDelete();\n      }).catch(function () {});\n    },\n    saveDelete: function saveDelete() {\n      var _this7 = this;\n\n      var ids = [];\n      ids.push(this.form.id + \"\");\n      console.log(ids);\n      this.$axios({\n        method: \"post\",\n        url: '/sys/device/delete',\n        data: JSON.stringify(ids),\n        // 设置请求头\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true //跨域请求\n\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this7.$message.success('操作完成');\n\n          _this7.gettree(); //局部刷新表格                     \n\n        } else {\n          _this7.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this7.$message.error(e);\n      });\n    },\n    // 编辑操作\n    handleEdit: function handleEdit(index, row) {\n      this.editVisible = true; // this.idx = index;\n\n      this.form = row;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      }\n    },\n    // 保存编辑\n    saveEdit: function saveEdit() {\n      var _this8 = this;\n\n      console.log('this.form', this.form);\n      this.editVisible = false; // 文件上传\n\n      this.$axios({\n        method: \"POST\",\n        url: '/sys/device/update',\n        data: JSON.stringify(this.form),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this8.$message.success('操作完成'); // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\n\n\n          _this8.gettree(); //局部刷新表格               \n\n        } else {\n          _this8.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this8.$message.error(e);\n      });\n    },\n    //控制树形菜单\n    handleNodeClick: function handleNodeClick(data) {\n      if (data) {\n        if (data.sublist.length > 0) {\n          this.items = data.sublist;\n        } else {\n          var select = [];\n          select.push(data);\n          this.items = select;\n        }\n      }\n    }\n  },\n  created: function created() {\n    this.gettype();\n    this.getDevicetype();\n    this.getSubtype();\n    this.gettree();\n  }\n};",null]}