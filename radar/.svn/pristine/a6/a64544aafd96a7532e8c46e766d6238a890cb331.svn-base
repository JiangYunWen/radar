{"remainingRequest":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\radar\\src\\components\\Appliction\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\radar\\src\\components\\Appliction\\index.vue","mtime":1607579332849},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1596528110531},{"path":"D:\\vue\\radar\\node_modules\\babel-loader\\lib\\index.js","mtime":1596527889887},{"path":"D:\\vue\\radar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596527896256},{"path":"D:\\vue\\radar\\node_modules\\vue-loader\\lib\\index.js","mtime":1596528120726}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n// import { fetchData } from '../../api/index';\r\nexport default {\r\n  name: \"basetable\",\r\n  data() {\r\n    return {\r\n      query: {\r\n        appname: \"\",\r\n        limit: 10,\r\n        pageIndex: 1,\r\n        pageSize: 10,\r\n        pageTotal: 0,\r\n      },\r\n      app: {},\r\n      tableData1: [],\r\n      startNows: [],\r\n      applications: [],\r\n      nodes: [],\r\n      multipleSelection: [],\r\n      delList: [],\r\n      strdata: [],\r\n      editVisible: false,\r\n      addVisible: false,\r\n      editVisible1: false,\r\n      form: {},\r\n      idx: -1,\r\n      id: -1,\r\n      options: [],\r\n      ztree: \"\",\r\n      setting: {\r\n        data: {\r\n          simpleData: {\r\n            enable: true,\r\n            idKey: \"deviceId\",\r\n            pIdKey: \"parentId\",\r\n            rootPId: -1,\r\n          },\r\n          key: {\r\n            url: \"nourl\",\r\n            children: \"sublist\",\r\n          },\r\n        },\r\n        check: {\r\n          enable: true,\r\n          nocheckInherit: true,\r\n        },\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    for (var s = 1; s <= 50; s++) {\r\n      var str = {};\r\n      str[\"value\"] = s;\r\n      str[\"lable\"] = s;\r\n      this.startNows.push(str);\r\n    }\r\n    this.getTreeData2();\r\n    this.getData();\r\n    this.getDatafile();\r\n  },\r\n  methods: {\r\n    // 获取 easy-mock 的模拟数据\r\n    getData() {\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/sys/app/listData\",\r\n        data: JSON.stringify({\r\n          page: this.query.pageIndex,\r\n          limit: this.query.pageSize,\r\n          username: this.query.username,\r\n        }),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          if (res.data.code == 0) {\r\n            this.tableData1 = res.data.page.list;\r\n            for (var tab in this.tableData1) {\r\n              //   this.tableData1[tab][\"startNow\"] = \"\";\r\n              this.$set(this.tableData1[tab], \"startNow\", parseInt(tab) + 1);\r\n            }\r\n            console.log(\"this.sds\", this.tableData1);\r\n            this.query.pageTotal = res.data.page.total || 10; //1页数据\r\n            this.query.pageIndex = res.data.page.page; //当前页\r\n            this.query.pageSize = res.data.page.limit; //数据总数\r\n          } else {\r\n            this.$message.error(res.data.msg);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          this.$message.error(\"获取数据失败！\");\r\n        });\r\n    },\r\n    setNodeDialog(index, row) {\r\n      this.$refs.start.blur();\r\n      this.app = row;\r\n      this.editVisible = true;\r\n      this.getTreeData();\r\n    },\r\n    setNodeDialog1(index, row) {\r\n      this.app = row;\r\n      this.editVisible1 = true;\r\n      this.getTreeData();\r\n    },\r\n\r\n    getTreeData() {\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/sys/device/select\",\r\n        data: JSON.stringify([2]),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          // var sublist =[];\r\n\r\n          if (data.code == 0) {\r\n            for (var node in data.data) {\r\n              for (var sub in data.data[node].sublist)\r\n                this.nodes.push(data.data[node].sublist[sub]);\r\n            }\r\n\r\n            this.ztree = $.fn.zTree.init($(\"#menuTree\"), this.setting, data.data);\r\n            //展开所有节点\r\n            this.ztree.expandAll(true);\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n    getTreeData2() {\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/sys/device/select\",\r\n        data: JSON.stringify([2]),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          if (data.code == 0) {\r\n            for (var node in data.data) {\r\n              for (var sub in data.data[node].sublist)\r\n                this.nodes.push(data.data[node].sublist[sub]);\r\n            }\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n    getDatafile() {\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/sys/file/listData\",\r\n        data: JSON.stringify({\r\n          page: this.query.pageIndex,\r\n          limit: this.query.pageSize,\r\n          username: this.query.username,\r\n        }),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          if (res.data.code == 0) {\r\n            this.applications = res.data.page.list;\r\n          } else {\r\n            this.$message.error(res.data.msg);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          this.$message.error(\"获取数据失败！\");\r\n        });\r\n    },\r\n    saveDelete(str) {\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/sys/app/delete\",\r\n        data: JSON.stringify(str),\r\n        // 设置请求头\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true, //跨域请求\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          if (data.code == 0) {\r\n            this.$message.success(\"操作完成\");\r\n            this.getData(); //局部刷新表格\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n    // 多选操作\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n    delAllSelection() {\r\n      const length = this.multipleSelection.length;\r\n      let str = [];\r\n      this.delList = this.delList.concat(this.multipleSelection);\r\n      for (let i = 0; i < this.delList.length; i++) {\r\n        str.push(this.delList[i].appId + \"\");\r\n      }\r\n      this.saveDelete(str);\r\n      this.multipleSelection = [];\r\n    },\r\n    addFile() {\r\n      this.addVisible = true;\r\n    },\r\n    saveNode() {\r\n      //获取选择的菜单\r\n      this.editVisible1 = false;\r\n      var nodes = this.ztree.getCheckedNodes(true);\r\n      var menuIdList = new Array();\r\n      for (var i = 0; i < nodes.length; i++) {\r\n        menuIdList.push(nodes[i].deviceId);\r\n      }\r\n\r\n      //向form表单中添加选中的菜单\r\n      if (menuIdList.length > 0) {\r\n        this.app.appNode = menuIdList[1];\r\n      }\r\n    },\r\n    saveAdd() {\r\n      this.addVisible = false;\r\n\r\n      this.$axios({\r\n        method: \"POST\",\r\n        url: \"/sys/app/save\",\r\n        data: JSON.stringify(this.app),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          if (data.code == 0) {\r\n            this.$message.success(\"操作完成\");\r\n            this.getData(); //局部刷新表格\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n          this.uploadLoading = false;\r\n        })\r\n        .catch((e) => {\r\n          this.uploadLoading = false;\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n    control(cmd) {\r\n      const length = this.multipleSelection.length;\r\n      var str = [];\r\n      this.delList = [];\r\n      this.delList = this.delList.concat(this.multipleSelection);\r\n\r\n      //根据优先级排序后遍历\r\n      str = this.delList.sort(function (a, b) {\r\n        return a.startNow - b.startNow;\r\n      });\r\n\r\n      for (let i = 0; i < str.length; i++) {\r\n        this.saveControl(str[i].appId, cmd);\r\n      }\r\n    },\r\n\r\n    saveControl(str, cmd) {\r\n      this.$axios({\r\n        method: \"POST\",\r\n        url: \"/sys/app/control\",\r\n        data: JSON.stringify({\r\n          appId: str,\r\n          cmd: cmd,\r\n        }),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          if (data.code == 0) {\r\n            this.$message.success(\"操作完成\");\r\n            // this.getData(); //局部刷新表格\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n          this.uploadLoading = false;\r\n        })\r\n        .catch((e) => {\r\n          this.uploadLoading = false;\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n    // 编辑操作\r\n    handleEdit(index, row) {\r\n      this.form = row;\r\n      this.editVisible = false;\r\n      //获取选择的菜单\r\n      var nodes = this.ztree.getCheckedNodes(true);\r\n      var menuIdList = new Array();\r\n      for (var i = 0; i < nodes.length; i++) {\r\n        menuIdList.push(nodes[i]);\r\n      }\r\n      //向form表单中添加选中的菜单\r\n      if (menuIdList.length > 0) {\r\n        this.form.appNode = menuIdList[1].deviceId;\r\n        // this.nodes=menuIdList;\r\n      }\r\n\r\n      this.$axios({\r\n        method: \"POST\",\r\n        url: \"/sys/app/update\",\r\n        data: JSON.stringify(this.form),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        withCredentials: true,\r\n      })\r\n        .then((res) => {\r\n          let data = res.data;\r\n          if (data.code == 0) {\r\n            // this.$message.success('操作完成') ;\r\n            this.$message.success(`修改成功`);\r\n            this.getData(); //局部刷新表格\r\n            this.getTreeData2();\r\n          } else {\r\n            this.$message.error(data.msg || \"操作失败\");\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          this.$message.error(e);\r\n        });\r\n    },\r\n\r\n    // 分页导航\r\n    // 每页显示的条数改变\r\n    changeSizeHandle(val) {\r\n      this.query.pageSize = val; // 改变每页显示的条数\r\n      this.query.pageIndex = 1; // 注意：在改变每页显示的条数时，要将页码显示到第一页\r\n      this.getData(); // 点击每页显示的条数时，显示第一页\r\n    },\r\n\r\n    // current-change用于监听页数改变，而内容也发生改变\r\n    currentChangeHandle(val) {\r\n      this.query.pageIndex = val; // 改变默认的页数\r\n      this.getData(); // 切换页码时，要获取每页显示的条数\r\n    },\r\n  },\r\n};\r\n",null]}