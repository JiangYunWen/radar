{"remainingRequest":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\babel-loader\\lib\\index.js!D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\360极速浏览器下载\\vue-manage-system-master\\src\\components\\page\\Device.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\src\\components\\page\\Device.vue","mtime":1596103373555},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\360极速浏览器下载\\vue-manage-system-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      form: {\n        id: '',\n        name: '',\n        type: '',\n        subtype: '',\n        parentId: '',\n        ipmiIp: '',\n        slotPosition: ''\n      },\n      items: [],\n      treedata: [],\n      defaultProps: {\n        children: 'sublist',\n        label: 'name'\n      },\n      tableData: [],\n      solts: [],\n      type: [],\n      deviceType: [],\n      subtype: [],\n      editVisible: false,\n      addVisible: false,\n      idx: -1\n    };\n  },\n  methods: {\n    //机箱数据获取\n    getDevice: function getDevice() {// this.$axios({\n      //     method:\"get\",\n      //     url:'/sys/device/status/tree?devicePid=246',\n      //     withCredentials:true,\n      // }).then(res => {\n      //     if(res.data.code==0){                                                     \n      //         this.items=res.data.devices;\n      //     }else{\n      //         this.$message.error(res.data.msg);\n      //     }\n      // }).catch(error => {\n      //     this.$message.error('获取数据失败！');\n      // });\n    },\n    gettree: function gettree() {\n      var _this = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/sys/device/select',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          // this.items=res.data.data.sublist;                                              \n          _this.treedata = res.data.data;\n\n          for (var i = 0; i < res.data.data.length; i++) {\n            _this.items = res.data.data[i].sublist;\n          }\n        } else {\n          _this.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this.$message.error('获取数据失败！');\n      });\n    },\n    gettype: function gettype() {\n      var _this2 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=DeviceEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this2.type = res.data.data;\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this2.$message.error('获取数据失败！');\n      });\n    },\n    formatType: function formatType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code) {\n          typelable = this.type[i].value;\n        }\n      }\n\n      return typelable;\n    },\n    getDevicetype: function getDevicetype() {\n      var _this3 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=ChassisEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this3.deviceType = res.data.data;\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this3.$message.error('获取数据失败！');\n      });\n    },\n    getSubtype: function getSubtype() {\n      var _this4 = this;\n\n      this.$axios({\n        method: \"get\",\n        url: '/getData/getEnum?enumName=BladeEnum',\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this4.subtype = res.data.data;\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this4.$message.error('获取数据失败！');\n      });\n    },\n    formatsubType: function formatsubType(row, column) {\n      var typelable = '';\n\n      for (var i = 0; i < this.type.length; i++) {\n        if (row.type === this.type[i].code && this.type[i].code === 4) {\n          for (var d = 0; d < this.deviceType.length; d++) {\n            if (row.subtype === this.deviceType[d].code) {\n              typelable = this.deviceType[d].value;\n            }\n          }\n        } else if (row.type === this.type[i].code && this.type[i].code === 5) {\n          for (var j = 0; j < this.subtype.length; j++) {\n            if (row.subtype === this.subtype[j].code) {\n              typelable = this.subtype[j].value;\n            }\n          }\n        }\n      }\n\n      return typelable;\n    },\n    //添加设备\n    addDevice: function addDevice() {\n      this.addVisible = true;\n    },\n    saveAdd: function saveAdd() {\n      var _this5 = this;\n\n      this.addVisible = false;\n\n      if (this.form.parentId == \"\") {\n        this.form.parentId = this.items[0].parentId;\n      }\n\n      console.log(this.items);\n      console.log(this.form);\n      this.$axios({\n        method: \"POST\",\n        url: '/sys/device/save',\n        data: JSON.stringify(this.form),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this5.$message.success('操作完成');\n\n          _this5.gettree(); //局部刷新表格               \n\n        } else {\n          _this5.$message.error(data.msg || '操作失败');\n        }\n\n        _this5.uploadLoading = false;\n      }).catch(function (e) {\n        _this5.uploadLoading = false;\n\n        _this5.$message.error(e);\n      });\n    },\n    // 删除操作\n    handleDelete: function handleDelete(index, row) {\n      var _this6 = this;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      } // 确认删除\n\n\n      this.$confirm('确定要删除吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this6.saveDelete();\n      }).catch(function () {});\n    },\n    saveDelete: function saveDelete() {\n      var _this7 = this;\n\n      var ids = [];\n      ids.push(this.form.id + \"\");\n      console.log(ids);\n      this.$axios({\n        method: \"post\",\n        url: '/sys/device/delete',\n        data: JSON.stringify(ids),\n        // 设置请求头\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true //跨域请求\n\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this7.$message.success('操作完成');\n\n          _this7.gettree(); //局部刷新表格                     \n\n        } else {\n          _this7.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this7.$message.error(e);\n      });\n    },\n    // 编辑操作\n    handleEdit: function handleEdit(index, row) {\n      this.editVisible = true; // this.idx = index;\n\n      this.form = row;\n\n      if (row.type === 4) {\n        this.form.id = row.menuId;\n      } else {\n        this.form.id = row.deviceId;\n      }\n    },\n    // 保存编辑\n    saveEdit: function saveEdit() {\n      var _this8 = this;\n\n      console.log(this.form);\n      this.editVisible = false; // 文件上传\n\n      this.$axios({\n        method: \"POST\",\n        url: '/sys/device/update',\n        data: JSON.stringify(this.form),\n        headers: {\n          'Content-Type': \"application/json\"\n        },\n        withCredentials: true\n      }).then(function (res) {\n        var data = res.data;\n\n        if (data.code == 0) {\n          _this8.$message.success('操作完成'); // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\n\n\n          _this8.gettree(); //局部刷新表格               \n\n        } else {\n          _this8.$message.error(data.msg || '操作失败');\n        }\n      }).catch(function (e) {\n        _this8.$message.error(e);\n      });\n    },\n    //控制树形菜单\n    handleNodeClick: function handleNodeClick(data) {\n      var _this9 = this;\n\n      console.log(data);\n      this.$axios({\n        method: \"get\",\n        url: '/sys/device/status/tree?devicePid=' + data.menuId,\n        withCredentials: true\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          _this9.items = res.data.devices;\n        } else {\n          _this9.$message.error(res.data.msg);\n        }\n      }).catch(function (error) {\n        _this9.$message.error('获取数据失败！');\n      });\n    }\n  },\n  created: function created() {\n    this.gettype();\n    this.getDevicetype();\n    this.getSubtype();\n    this.getDevice();\n    this.gettree();\n  }\n};",{"version":3,"sources":["Device.vue"],"names":[],"mappings":"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","sourcesContent":["\r\n<template>\r\n    <div>\r\n        <div class=\"crumbs\">\r\n            <el-breadcrumb separator=\"/\">\r\n                <el-breadcrumb-item>\r\n                    <i class=\"el-icon-lx-cascades\"></i> 设备管理\r\n                </el-breadcrumb-item>\r\n            </el-breadcrumb>\r\n        </div>\r\n        <div class=\"container\">\r\n             <el-row :gutter=\"20\" >\r\n                 <el-col :span=\"4\" style=\"height:400px\" >\r\n                   <el-card shadow=\"hover\" class=\"mgb20\" >\r\n                      <div slot=\"header\" class=\"clearfix\">\r\n                            <span>设备列表</span>\r\n                      </div>\r\n                      <el-tree :data=\"treedata\" node-key=\"menuId\"  :default-expanded-keys=\"[246]\" :props=\"defaultProps\" @node-click=\"handleNodeClick\"></el-tree>                                               \r\n                   </el-card>               \r\n                </el-col>           \r\n               <el-col :span=\"20\" >\r\n                   <el-card shadow=\"hover\" class=\"mgb20\" >     \r\n                        <div class=\"handle-box\">             \r\n                            <el-button\r\n                                class=\"handle-add mr10\"\r\n                                @click=\"addDevice\"\r\n                            ><i class=\"el-icon-circle-plus\" style=\"font-size:12px;color:#00EC00;margin-right: 5px;\" ></i>添加</el-button>\r\n                            <el-input  placeholder=\"设备名\" class=\"handle-input mr10\"></el-input>\r\n                            <el-button ><i class=\"el-icon-search\" style=\"font-size:12px;color:#0080FF;margin-right: 5px;\" ></i>搜索</el-button>\r\n                        </div>\r\n                        <el-table\r\n                            :data=\"items\"\r\n                            style=\"width: 100%;margin-bottom: 20px;\"                           \r\n                            border\r\n                            default-expand-all\r\n                            >                                 \r\n                            <el-table-column prop=\"name\" label=\"设备名称\"  width=\"180\"></el-table-column>\r\n                            <el-table-column prop=\"chassis\" label=\"设备编号\"></el-table-column>  \r\n                            <el-table-column prop=\"type\" label=\"设备类型\"  width=\"180\" :formatter=\"formatType\"></el-table-column>\r\n                            <el-table-column prop=\"subtype\" label=\"设备子类型\"  width=\"180\" :formatter=\"formatsubType\"></el-table-column>\r\n                            <el-table-column prop=\"ipmiIp\" label=\"设备IP\" ></el-table-column>                           \r\n                            <el-table-column prop=\"slotPosition\" label=\"槽位号\" ></el-table-column>\r\n\r\n                            <el-table-column label=\"操作\" width=\"200\" align=\"center\">\r\n                                <template slot-scope=\"scope\">\r\n                                    <el-button\r\n                                        type=\"text\"\r\n                                        icon=\"el-icon-edit\"\r\n                                        @click=\"handleEdit(scope.$index, scope.row)\"\r\n                                    >编辑</el-button>\r\n                                    <el-button\r\n                                        type=\"text\"\r\n                                        icon=\"el-icon-delete\"\r\n                                        class=\"red\"\r\n                                        @click=\"handleDelete(scope.$index, scope.row)\"\r\n                                    >删除</el-button>\r\n                                </template>\r\n                            </el-table-column>\r\n                        </el-table>\r\n\r\n                        <!--div class=\"pagination\">\r\n                            <el-pagination \r\n                                @size-change=\"changeSizeHandle\" \r\n                                @current-change=\"currentChangeHandle\"\r\n                                :current-page=\"query.pageIndex\"  \r\n                                layout=\"total, sizes, prev, pager, next, jumper\" \r\n                                :total=\"pageTotal\" background>\r\n                            </el-pagination>\r\n                        </div-->\r\n                        </el-card>               \r\n                    </el-col>           \r\n                </el-row> \r\n        </div>\r\n        \r\n\r\n        <!-- 编辑弹出框 -->\r\n        <el-dialog title=\"编辑设备\" :visible.sync=\"editVisible\" width=\"30%\">\r\n            <el-form ref=\"form\" :model=\"form\" label-width=\"100px\" style=\"width: 300px; margin-left:50px;\">\r\n                <el-form-item label=\"设备名称\">\r\n                    <el-input v-model=\"form.name\" ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"设备类型\" >               \r\n                    <el-radio-group v-model=\"form.type\" >\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in type\">{{item.value}}</el-radio>\r\n                    </el-radio-group>        \r\n                </el-form-item>\r\n                <template v-if=\"form.type===4\">\r\n                <el-form-item label=\"设备子类型\" >\r\n                    <el-select v-model=\"form.subtype\" >\r\n                        <el-option v-for=\"device in deviceType\" :key=\"device.code\" :label=\"device.value\" :value=\"device.code\">{{device.value}}</el-option>\r\n                    </el-select>\r\n                    <!--el-radio-group v-model=\"form.subtype\">\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in deviceType\">{{item.value}}</el-radio>\r\n                    </el-radio-group-->                       \r\n                </el-form-item>\r\n                </template>\r\n                <template v-else-if=\"form.type===5\">\r\n                <el-form-item label=\"上级设备\" >\r\n                    <el-select v-model=\"form.parentId\" >\r\n                        <el-option v-for=\"tree in items\" :key=\"tree.menuId\" :label=\"tree.name\" :value=\"tree.menuId\">{{tree.name}}</el-option>\r\n                    </el-select>\r\n                    <!--el-radio-group v-model=\"form.subtype\">\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in deviceType\">{{item.value}}</el-radio>\r\n                    </el-radio-group-->                       \r\n                </el-form-item>\r\n                <el-form-item label=\"设备子类型\" >\r\n                    <el-select v-model=\"form.subtype\" >\r\n                        <el-option v-for=\"solt in subtype\" :key=\"solt.code\" :label=\"solt.value\" :value=\"solt.code\">{{solt.value}}</el-option>\r\n                    </el-select>                     \r\n                </el-form-item>\r\n                 <el-form-item label=\"设备IP\">\r\n                    <el-input v-model=\"form.ipmiIp\" ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"槽位号\">\r\n                    <el-input v-model=\"form.slotPosition\" ></el-input>\r\n                </el-form-item>\r\n                </template>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"editVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"saveEdit\">确 定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n\r\n\r\n        <!--增加弹出框-->\r\n          <el-dialog title=\"增加设备\"   :visible.sync=\"addVisible\" width=\"40%\">\r\n            <el-form ref=\"form\" :model=\"form\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\r\n                <el-form-item label=\"设备名称\">\r\n                    <el-input v-model=\"form.name\" ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"设备类型\" >\r\n                    <el-radio-group v-model=\"form.type\" >\r\n                        <el-radio :label=\"item.code\" :key=\"item.code\" v-for=\"item in type\">{{item.value}}</el-radio>\r\n                    </el-radio-group>                \r\n                </el-form-item>\r\n                <template v-if=\"form.type===4\">\r\n                <el-form-item label=\"设备子类型\" >\r\n                    <el-select v-model=\"form.subtype\" >\r\n                        <el-option v-for=\"device in deviceType\" :key=\"device.code\" :label=\"device.value\" :value=\"device.code\">{{device.value}}</el-option>\r\n                    </el-select>                      \r\n                </el-form-item>\r\n                </template>\r\n                <template v-else-if=\"form.type===5\">\r\n                <el-form-item label=\"上级设备\" >\r\n                    <el-select v-model=\"form.parentId\" >\r\n                        <el-option v-for=\"tree in items\" :key=\"tree.menuId\" :label=\"tree.name\" :value=\"tree.menuId\">{{tree.name}}</el-option>\r\n                    </el-select>                    \r\n                </el-form-item>\r\n                <el-form-item label=\"设备子类型\" >\r\n                    <el-select v-model=\"form.subtype\" >\r\n                        <el-option v-for=\"solt in subtype\" :key=\"solt.code\" :label=\"solt.value\" :value=\"solt.code\">{{solt.value}}</el-option>\r\n                    </el-select>                     \r\n                </el-form-item>\r\n                 <el-form-item label=\"设备IP\">\r\n                    <el-input v-model=\"form.ipmiIp\" ></el-input>\r\n                </el-form-item>\r\n                 <el-form-item label=\"槽位号\">\r\n                    <el-input v-model=\"form.slotPosition\" ></el-input>\r\n                </el-form-item>\r\n                </template>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"addVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"saveAdd\">确 定</el-button>\r\n            </span>\r\n          </el-dialog>\r\n\r\n\r\n    </div>\r\n</template>\r\n\r\n \r\n \r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        form:{\r\n            id:'',\r\n            name:'',\r\n            type:'',\r\n            subtype:'',\r\n            parentId:'',\r\n            ipmiIp:'',\r\n            slotPosition:''\r\n        },\r\n        items:[],\r\n        treedata:[],\r\n        defaultProps:{\r\n            children: 'sublist',\r\n            label: 'name'\r\n        },\r\n        tableData: [],\r\n        solts:[],\r\n        type:[],\r\n        deviceType:[],\r\n        subtype:[],\r\n        editVisible: false,\r\n        addVisible:false,\r\n        idx: -1,\r\n      }\r\n    },\r\n    methods: {\r\n     //机箱数据获取\r\n      getDevice(){\r\n            // this.$axios({\r\n            //     method:\"get\",\r\n            //     url:'/sys/device/status/tree?devicePid=246',\r\n            //     withCredentials:true,\r\n            // }).then(res => {\r\n            //     if(res.data.code==0){                                                     \r\n            //         this.items=res.data.devices;\r\n            //     }else{\r\n            //         this.$message.error(res.data.msg);\r\n            //     }\r\n            // }).catch(error => {\r\n            //     this.$message.error('获取数据失败！');\r\n            // });\r\n      },\r\n      gettree(){\r\n            this.$axios({\r\n                method:\"get\",\r\n                url:'/sys/device/select',\r\n                withCredentials:true,\r\n            }).then(res => {\r\n                if(res.data.code==0){       \r\n                    // this.items=res.data.data.sublist;                                              \r\n                    this.treedata=res.data.data;\r\n                    for(var i=0;i<res.data.data.length;i++){\r\n                        this.items=res.data.data[i].sublist;\r\n                    }\r\n                    \r\n                }else{\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n      },\r\n        gettype(){\r\n            this.$axios({\r\n                method:\"get\",\r\n                url:'/getData/getEnum?enumName=DeviceEnum',\r\n                withCredentials:true,\r\n            }).then(res => {\r\n                if(res.data.code==0){                                                     \r\n                    this.type=res.data.data;\r\n                }else{\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n      },\r\n      formatType(row, column){\r\n            var typelable=''; \r\n            for(var i=0;i<this.type.length;i++){\r\n                if(row.type===this.type[i].code){\r\n                    typelable=this.type[i].value;\r\n                }\r\n            }\r\n            return typelable;\r\n      },\r\n        getDevicetype(){\r\n            this.$axios({\r\n                method:\"get\",\r\n                url:'/getData/getEnum?enumName=ChassisEnum',\r\n                withCredentials:true,\r\n            }).then(res => {\r\n                if(res.data.code==0){                                                     \r\n                    this.deviceType=res.data.data;\r\n                }else{\r\n                        this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n      },\r\n        getSubtype(){\r\n            this.$axios({\r\n                method:\"get\",\r\n                url:'/getData/getEnum?enumName=BladeEnum',\r\n                withCredentials:true,\r\n            }).then(res => {\r\n                if(res.data.code==0){                                                     \r\n                    this.subtype=res.data.data;\r\n                }else{\r\n                        this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n      },\r\n      formatsubType(row, column){\r\n            var typelable=''; \r\n             for(var i=0;i<this.type.length;i++){\r\n                if(row.type===this.type[i].code&&this.type[i].code===4){\r\n                     for(var d=0;d<this.deviceType.length;d++){\r\n                          if(row.subtype===this.deviceType[d].code){\r\n                                typelable=this.deviceType[d].value;\r\n                          }\r\n                     }\r\n                }else if(row.type===this.type[i].code&&this.type[i].code===5){\r\n                    for(var j=0;j<this.subtype.length;j++){\r\n                          if(row.subtype===this.subtype[j].code){\r\n                                typelable=this.subtype[j].value;                               \r\n                          }\r\n                     }\r\n                }\r\n            }\r\n            return typelable;\r\n      },\r\n      //添加设备\r\n        addDevice(){\r\n            this.addVisible = true;\r\n        },\r\n        saveAdd(){\r\n            this.addVisible = false;\r\n            if(this.form.parentId==\"\"){\r\n                    this.form.parentId=this.items[0].parentId;              \r\n            }\r\n            console.log(this.items);\r\n            console.log(this.form);\r\n            this.$axios({\r\n                method: \"POST\",\r\n                url: '/sys/device/save',\r\n                data: JSON.stringify(this.form),\r\n                headers: {\r\n                        'Content-Type': \"application/json\"\r\n                 },\r\n                 withCredentials:true,\r\n            }).then((res) => {\r\n                let data = res.data\r\n                if(data.code==0) {         \r\n                    this.$message.success('操作完成') ;\r\n                    this.gettree();//局部刷新表格               \r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n                this.uploadLoading = false\r\n            }).catch((e)=>{\r\n                this.uploadLoading = false\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        // 删除操作\r\n        handleDelete(index, row) {\r\n            if(row.type===4){\r\n                this.form.id = row.menuId;       \r\n            }else{\r\n                this.form.id = row.deviceId;  \r\n            }\r\n            // 确认删除\r\n            this.$confirm('确定要删除吗？', '提示', {\r\n                type: 'warning'\r\n            }).then(() => {\r\n                    this.saveDelete();\r\n                }).catch(() => {});\r\n        },\r\n        saveDelete(){   \r\n            let ids=[];                         \r\n            ids.push(this.form.id+\"\");\r\n            console.log(ids);\r\n            this.$axios({\r\n                method: \"post\",\r\n                url: '/sys/device/delete',\r\n                data: JSON.stringify(ids),\r\n                // 设置请求头\r\n                headers: {\r\n                   'Content-Type': \"application/json\"\r\n                },\r\n                 withCredentials:true,//跨域请求\r\n            }).then((res) => {\r\n                let data = res.data;\r\n                if(data.code==0) {         \r\n                    this.$message.success('操作完成') ;\r\n                    this.gettree();//局部刷新表格                     \r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n            }).catch((e)=>{\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        // 编辑操作\r\n        handleEdit(index, row) {\r\n            this.editVisible = true;\r\n\r\n            // this.idx = index;\r\n            this.form = row;\r\n            if(row.type===4){\r\n                this.form.id = row.menuId;       \r\n            }else{\r\n                this.form.id = row.deviceId;  \r\n            }\r\n               \r\n        },\r\n        // 保存编辑\r\n        saveEdit() {\r\n            console.log(this.form);\r\n            this.editVisible = false;\r\n            // 文件上传\r\n            this.$axios({\r\n                method: \"POST\",\r\n                url: '/sys/device/update',\r\n                data: JSON.stringify(this.form),\r\n                headers: {\r\n                        'Content-Type': \"application/json\"\r\n                 },\r\n                 withCredentials:true,\r\n            }).then((res) => {\r\n                let data = res.data\r\n                if(data.code==0) {         \r\n                    this.$message.success('操作完成') ;\r\n                    // this.$message.success(`修改第 ${this.idx + 1} 行成功`);\r\n                   this.gettree();//局部刷新表格               \r\n                } else {\r\n                    this.$message.error(data.msg || '操作失败')\r\n                }\r\n            }).catch((e)=>{\r\n                this.$message.error(e)\r\n            });\r\n        },\r\n        //控制树形菜单\r\n        handleNodeClick(data) {\r\n        console.log(data);\r\n         this.$axios({\r\n                method:\"get\",\r\n                url:'/sys/device/status/tree?devicePid='+data.menuId,\r\n                withCredentials:true,\r\n            }).then(res => {\r\n                if(res.data.code==0){                                                     \r\n                    this.items=res.data.devices;\r\n                }else{\r\n                    this.$message.error(res.data.msg);\r\n                }\r\n            }).catch(error => {\r\n                this.$message.error('获取数据失败！');\r\n            });\r\n      },\r\n    },\r\n    created:function(){\r\n        this.gettype();\r\n        this.getDevicetype();\r\n        this.getSubtype();\r\n        this.getDevice();\r\n        this.gettree();\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n.handle-box {\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.handle-select {\r\n    width: 120px;\r\n}\r\n\r\n.handle-input {\r\n    width: 200px;\r\n    display: inline-block;\r\n}\r\n.table {\r\n    width: 100%;\r\n    font-size: 14px;\r\n}\r\n.red {\r\n    color: #ff0000;\r\n}\r\n.mr10 {\r\n    margin-right: 10px;\r\n}\r\n.table-td-thumb {\r\n    display: block;\r\n    margin: auto;\r\n    width: 40px;\r\n    height: 40px;\r\n}\r\n</style>"],"sourceRoot":"src/components/page"}]}